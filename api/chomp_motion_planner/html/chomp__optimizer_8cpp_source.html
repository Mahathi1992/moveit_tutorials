<html><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<title>chomp_motion_planner: chomp_optimizer.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="jquery.js"></script>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_878a9c9572e57ce5d1c4027d9f12c695.html">moveit</a></li><li class="navelem"><a class="el" href="dir_3fd8217fdc8760fb87fad46ec7fbff64.html">moveit_planners</a></li><li class="navelem"><a class="el" href="dir_e3be14f2f6743a20b31de11c55c35f8c.html">chomp</a></li><li class="navelem"><a class="el" href="dir_18942ddd6af2b44f36aaad99ea3df70b.html">chomp_motion_planner</a></li><li class="navelem"><a class="el" href="dir_9bb3198d8aa38f0293d02ae81b7d1ec9.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">chomp_optimizer.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="chomp__optimizer_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*********************************************************************</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Software License Agreement (BSD License)</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *  Copyright (c) 2009, Willow Garage, Inc.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *  All rights reserved.</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *  Redistribution and use in source and binary forms, with or without</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *  modification, are permitted provided that the following conditions</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *  are met:</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *   * Redistributions of source code must retain the above copyright</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> *     notice, this list of conditions and the following disclaimer.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *   * Redistributions in binary form must reproduce the above</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> *     copyright notice, this list of conditions and the following</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> *     disclaimer in the documentation and/or other materials provided</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> *     with the distribution.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> *   * Neither the name of Willow Garage nor the names of its</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> *     contributors may be used to endorse or promote products derived</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> *     from this software without specific prior written permission.</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> *  &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> *  LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> *  FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"> *  COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"> *  INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"> *  BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"> *  LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"> *  CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment"> *  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"> *  ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment"> *  POSSIBILITY OF SUCH DAMAGE.</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment"> *********************************************************************/</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">/* Author: Mrinal Kalakrishnan */</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="chomp__optimizer_8h.html">chomp_motion_planner/chomp_optimizer.h</a>&gt;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &lt;ros/ros.h&gt;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &lt;visualization_msgs/MarkerArray.h&gt;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="chomp__utils_8h.html">chomp_motion_planner/chomp_utils.h</a>&gt;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &lt;moveit/robot_model/robot_model.h&gt;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &lt;moveit/robot_state/conversions.h&gt;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &lt;moveit/planning_scene/planning_scene.h&gt;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &lt;eigen3/Eigen/LU&gt;</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &lt;eigen3/Eigen/Core&gt;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &lt;random&gt;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacechomp.html">chomp</a></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;{</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="keywordtype">double</span> <a class="code" href="namespacechomp.html#a3cb4d6d2179e5505bce99ccf70e4b61e">getRandomDouble</a>()</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;{</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  std::default_random_engine seed;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  std::uniform_real_distribution&lt;&gt; uniform(0.0, 1.0);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keywordflow">return</span> uniform(seed);</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;}</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<a class="code" href="classchomp_1_1ChompOptimizer.html#a08e1bf73cd9db50dcfdfe627aba4282d">ChompOptimizer::ChompOptimizer</a>(ChompTrajectory* trajectory, <span class="keyword">const</span> planning_scene::PlanningSceneConstPtr&amp; planning_scene,</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                               <span class="keyword">const</span> std::string&amp; planning_group, <span class="keyword">const</span> ChompParameters* parameters,</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                               <span class="keyword">const</span> moveit::core::RobotState&amp; start_state)</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  : full_trajectory_(trajectory)</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  , robot_model_(planning_scene-&gt;getRobotModel())</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  , planning_group_(planning_group)</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  , parameters_(parameters)</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  , group_trajectory_(*full_trajectory_, planning_group_, <a class="code" href="namespacechomp.html#a00ceb4fc5e1c66b78ed4f27ec5070890">DIFF_RULE_LENGTH</a>)</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  , planning_scene_(planning_scene)</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  , state_(start_state)</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  , start_state_(start_state)</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  , initialized_(false)</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;{</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  std::vector&lt;std::string&gt; cd_names;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  planning_scene-&gt;getCollisionDetectorNames(cd_names);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  ROS_INFO_STREAM(<span class="stringliteral">&quot;The following collision detectors are available in the planning scene.&quot;</span>);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> std::string&amp; cd_name : cd_names)</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    ROS_INFO_STREAM(cd_name);</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  }</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  ROS_INFO_STREAM(<span class="stringliteral">&quot;Active collision detector is: &quot;</span> + planning_scene-&gt;getActiveCollisionDetectorName());</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  hy_env_ = <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>collision_detection::CollisionEnvHybrid*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="namespacechomp.html#a3cb4d6d2179e5505bce99ccf70e4b61e">   82</a></span>&#160;      planning_scene-&gt;getCollisionEnv(planning_scene-&gt;getActiveCollisionDetectorName()).get());</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="keywordflow">if</span> (!hy_env_)</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    ROS_WARN_STREAM(<span class="stringliteral">&quot;Could not initialize hybrid collision world from planning scene&quot;</span>);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  }</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="classchomp_1_1ChompOptimizer.html#a08e1bf73cd9db50dcfdfe627aba4282d">   89</a></span>&#160;  initialize();</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;}</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classchomp_1_1ChompOptimizer.html#ae07453fd4e982a96406e68ffd7058f2b">ChompOptimizer::initialize</a>()</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;{</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <span class="comment">// init some variables:</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#a636d147684c72ba10b6eac8624ceb20b">num_vars_free_</a> = <a class="code" href="classchomp_1_1ChompOptimizer.html#ac8a33d22edb4dac95d88480f0b114ba1">group_trajectory_</a>.<a class="code" href="classchomp_1_1ChompTrajectory.html#afb272cf4167ff09cf8a264e305e70b8f">getNumFreePoints</a>();</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#a10178cbef38ab61ec8efe6ff1f537b37">num_vars_all_</a> = <a class="code" href="classchomp_1_1ChompOptimizer.html#ac8a33d22edb4dac95d88480f0b114ba1">group_trajectory_</a>.<a class="code" href="classchomp_1_1ChompTrajectory.html#a61bca7c981f6f94adaee9703828d34ff">getNumPoints</a>();</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#ada498aefc4c6e9c5a9ee6e7b0b71fefc">num_joints_</a> = <a class="code" href="classchomp_1_1ChompOptimizer.html#ac8a33d22edb4dac95d88480f0b114ba1">group_trajectory_</a>.<a class="code" href="classchomp_1_1ChompTrajectory.html#a972938a9774b1e0654d56ed7dd7da0e9">getNumJoints</a>();</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#ab2028b705c347074aef529a0c4a93534">free_vars_start_</a> = <a class="code" href="classchomp_1_1ChompOptimizer.html#ac8a33d22edb4dac95d88480f0b114ba1">group_trajectory_</a>.<a class="code" href="classchomp_1_1ChompTrajectory.html#a46b4d7d90712373552677264d74701be">getStartIndex</a>();</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#a9f4df819373a8fc4fc4c33bf3e61c3a2">free_vars_end_</a> = <a class="code" href="classchomp_1_1ChompOptimizer.html#ac8a33d22edb4dac95d88480f0b114ba1">group_trajectory_</a>.<a class="code" href="classchomp_1_1ChompTrajectory.html#a452a2c36a6935ca0e6c88c1830650954">getEndIndex</a>();</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  collision_detection::CollisionRequest req;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  collision_detection::CollisionResult res;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  req.group_name = <a class="code" href="classchomp_1_1ChompOptimizer.html#a0bf78e07c502c4a51d2f87ea4762e622">planning_group_</a>;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  ros::WallTime wt = ros::WallTime::now();</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#a40a132a004cb8f02a496f552bdcefeb5">hy_env_</a>-&gt;getCollisionGradients(req, res, <a class="code" href="classchomp_1_1ChompOptimizer.html#a41265fb8d09d499844098b979538d6df">state_</a>, &amp;<a class="code" href="classchomp_1_1ChompOptimizer.html#a45348d687e33567bade08b7c7d54f35a">planning_scene_</a>-&gt;getAllowedCollisionMatrix(), <a class="code" href="classchomp_1_1ChompOptimizer.html#afbb9263fa4e62b19d6e8128cd57c477b">gsr_</a>);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  ROS_INFO_STREAM(<span class="stringliteral">&quot;First coll check took &quot;</span> &lt;&lt; (ros::WallTime::now() - wt));</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#a5ec7779d032e89339c31556ef37f61f1">num_collision_points_</a> = 0;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> collision_detection::GradientInfo&amp; gradient : <a class="code" href="classchomp_1_1ChompOptimizer.html#afbb9263fa4e62b19d6e8128cd57c477b">gsr_</a>-&gt;gradients_)</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <a class="code" href="classchomp_1_1ChompOptimizer.html#a5ec7779d032e89339c31556ef37f61f1">num_collision_points_</a> += gradient.gradients.size();</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  }</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="comment">// set up the joint costs:</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#ad522962453ef1b68c88b0d177e49add6">joint_costs_</a>.reserve(<a class="code" href="classchomp_1_1ChompOptimizer.html#ada498aefc4c6e9c5a9ee6e7b0b71fefc">num_joints_</a>);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordtype">double</span> max_cost_scale = 0.0;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#ac449fe23198404a23ccc12d45ad0a0cb">joint_model_group_</a> = <a class="code" href="classchomp_1_1ChompOptimizer.html#a45348d687e33567bade08b7c7d54f35a">planning_scene_</a>-&gt;getRobotModel()-&gt;getJointModelGroup(<a class="code" href="classchomp_1_1ChompOptimizer.html#a0bf78e07c502c4a51d2f87ea4762e622">planning_group_</a>);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <span class="keyword">const</span> std::vector&lt;const moveit::core::JointModel*&gt; joint_models = <a class="code" href="classchomp_1_1ChompOptimizer.html#ac449fe23198404a23ccc12d45ad0a0cb">joint_model_group_</a>-&gt;getActiveJointModels();</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; joint_models.size(); i++)</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  {</div>
<div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="classchomp_1_1ChompOptimizer.html#ae07453fd4e982a96406e68ffd7058f2b">  124</a></span>&#160;    <span class="keywordtype">double</span> joint_cost = 1.0;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="comment">// nh.param(&quot;joint_costs/&quot; + joint_models[i]-&gt;getName(), joint_cost, 1.0);</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    std::vector&lt;double&gt; derivative_costs(3);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    derivative_costs[0] = joint_cost * <a class="code" href="classchomp_1_1ChompOptimizer.html#a82519d9ad09cad7a441c19136db216bf">parameters_</a>-&gt;<a class="code" href="classchomp_1_1ChompParameters.html#ad3636d8c33aa7e70e482749ff58fe7cc">smoothness_cost_velocity_</a>;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    derivative_costs[1] = joint_cost * <a class="code" href="classchomp_1_1ChompOptimizer.html#a82519d9ad09cad7a441c19136db216bf">parameters_</a>-&gt;<a class="code" href="classchomp_1_1ChompParameters.html#a6d1eeb3dec5f60058775b67bc748977b">smoothness_cost_acceleration_</a>;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    derivative_costs[2] = joint_cost * <a class="code" href="classchomp_1_1ChompOptimizer.html#a82519d9ad09cad7a441c19136db216bf">parameters_</a>-&gt;<a class="code" href="classchomp_1_1ChompParameters.html#a5fccd7eb47435c5a451c02a734a6859a">smoothness_cost_jerk_</a>;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <a class="code" href="classchomp_1_1ChompOptimizer.html#ad522962453ef1b68c88b0d177e49add6">joint_costs_</a>.push_back(<a class="code" href="classchomp_1_1ChompCost.html">ChompCost</a>(<a class="code" href="classchomp_1_1ChompOptimizer.html#ac8a33d22edb4dac95d88480f0b114ba1">group_trajectory_</a>, i, derivative_costs, <a class="code" href="classchomp_1_1ChompOptimizer.html#a82519d9ad09cad7a441c19136db216bf">parameters_</a>-&gt;<a class="code" href="classchomp_1_1ChompParameters.html#a8a5689561abc217f035eb90623cfc2bc">ridge_factor_</a>));</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordtype">double</span> cost_scale = <a class="code" href="classchomp_1_1ChompOptimizer.html#ad522962453ef1b68c88b0d177e49add6">joint_costs_</a>[i].getMaxQuadCostInvValue();</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordflow">if</span> (max_cost_scale &lt; cost_scale)</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      max_cost_scale = cost_scale;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160; </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="comment">// scale the smoothness costs</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classchomp_1_1ChompOptimizer.html#ada498aefc4c6e9c5a9ee6e7b0b71fefc">num_joints_</a>; i++)</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <a class="code" href="classchomp_1_1ChompOptimizer.html#ad522962453ef1b68c88b0d177e49add6">joint_costs_</a>[i].scale(max_cost_scale);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  }</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="comment">// allocate memory for matrices:</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#a0ac29189993f328f89f8fcec04d640ea">smoothness_increments_</a> = Eigen::MatrixXd::Zero(<a class="code" href="classchomp_1_1ChompOptimizer.html#a636d147684c72ba10b6eac8624ceb20b">num_vars_free_</a>, <a class="code" href="classchomp_1_1ChompOptimizer.html#ada498aefc4c6e9c5a9ee6e7b0b71fefc">num_joints_</a>);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#a8de144c16b30bdb83c47c8b3ed84517f">collision_increments_</a> = Eigen::MatrixXd::Zero(<a class="code" href="classchomp_1_1ChompOptimizer.html#a636d147684c72ba10b6eac8624ceb20b">num_vars_free_</a>, <a class="code" href="classchomp_1_1ChompOptimizer.html#ada498aefc4c6e9c5a9ee6e7b0b71fefc">num_joints_</a>);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#a4fe49a4b1890b27815319f947cb30cf9">final_increments_</a> = Eigen::MatrixXd::Zero(<a class="code" href="classchomp_1_1ChompOptimizer.html#a636d147684c72ba10b6eac8624ceb20b">num_vars_free_</a>, <a class="code" href="classchomp_1_1ChompOptimizer.html#ada498aefc4c6e9c5a9ee6e7b0b71fefc">num_joints_</a>);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#a06fd3548c17ad7e728a7d1e6b9394bdd">smoothness_derivative_</a> = Eigen::VectorXd::Zero(<a class="code" href="classchomp_1_1ChompOptimizer.html#a10178cbef38ab61ec8efe6ff1f537b37">num_vars_all_</a>);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#a630a1c0d5720867f82d83e16b2d43778">jacobian_</a> = Eigen::MatrixXd::Zero(3, <a class="code" href="classchomp_1_1ChompOptimizer.html#ada498aefc4c6e9c5a9ee6e7b0b71fefc">num_joints_</a>);</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#a9e5a7b8bd8a882869725e42e92237ba7">jacobian_pseudo_inverse_</a> = Eigen::MatrixXd::Zero(<a class="code" href="classchomp_1_1ChompOptimizer.html#ada498aefc4c6e9c5a9ee6e7b0b71fefc">num_joints_</a>, 3);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#aacf642cdbcedc4e4ac82519aa09767ea">jacobian_jacobian_tranpose_</a> = Eigen::MatrixXd::Zero(3, 3);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#a1460cddc9f6d8fb5b819100f77126179">random_state_</a> = Eigen::VectorXd::Zero(<a class="code" href="classchomp_1_1ChompOptimizer.html#ada498aefc4c6e9c5a9ee6e7b0b71fefc">num_joints_</a>);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#a88db4a4ea2dd1f55b819d21aab70785f">joint_state_velocities_</a> = Eigen::VectorXd::Zero(<a class="code" href="classchomp_1_1ChompOptimizer.html#ada498aefc4c6e9c5a9ee6e7b0b71fefc">num_joints_</a>);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#a54068cc585225da9b42b39f95a7a0354">group_trajectory_backup_</a> = <a class="code" href="classchomp_1_1ChompOptimizer.html#ac8a33d22edb4dac95d88480f0b114ba1">group_trajectory_</a>.<a class="code" href="classchomp_1_1ChompTrajectory.html#ae0dc82cbaec33cbe55805e66264f7fc8">getTrajectory</a>();</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#a52c1ffa2020514e1da0dc51cfc607c02">best_group_trajectory_</a> = <a class="code" href="classchomp_1_1ChompOptimizer.html#ac8a33d22edb4dac95d88480f0b114ba1">group_trajectory_</a>.<a class="code" href="classchomp_1_1ChompTrajectory.html#ae0dc82cbaec33cbe55805e66264f7fc8">getTrajectory</a>();</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#a70c367db1a30edc1cb3c97c4328749d2">collision_point_joint_names_</a>.resize(<a class="code" href="classchomp_1_1ChompOptimizer.html#a10178cbef38ab61ec8efe6ff1f537b37">num_vars_all_</a>, std::vector&lt;std::string&gt;(<a class="code" href="classchomp_1_1ChompOptimizer.html#a5ec7779d032e89339c31556ef37f61f1">num_collision_points_</a>));</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#abe45133eaaa4dfbc2224abaa25a5f7e1">collision_point_pos_eigen_</a>.resize(<a class="code" href="classchomp_1_1ChompOptimizer.html#a10178cbef38ab61ec8efe6ff1f537b37">num_vars_all_</a>, EigenSTL::vector_Vector3d(<a class="code" href="classchomp_1_1ChompOptimizer.html#a5ec7779d032e89339c31556ef37f61f1">num_collision_points_</a>));</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#a18cc68cc4fd817ebf5f5e51297a8e7e8">collision_point_vel_eigen_</a>.resize(<a class="code" href="classchomp_1_1ChompOptimizer.html#a10178cbef38ab61ec8efe6ff1f537b37">num_vars_all_</a>, EigenSTL::vector_Vector3d(<a class="code" href="classchomp_1_1ChompOptimizer.html#a5ec7779d032e89339c31556ef37f61f1">num_collision_points_</a>));</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#a8c1ece38b849b164289f5753945f3c95">collision_point_acc_eigen_</a>.resize(<a class="code" href="classchomp_1_1ChompOptimizer.html#a10178cbef38ab61ec8efe6ff1f537b37">num_vars_all_</a>, EigenSTL::vector_Vector3d(<a class="code" href="classchomp_1_1ChompOptimizer.html#a5ec7779d032e89339c31556ef37f61f1">num_collision_points_</a>));</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#acf4ca8d231b15a584ae0ce98779850bd">joint_axes_</a>.resize(<a class="code" href="classchomp_1_1ChompOptimizer.html#a10178cbef38ab61ec8efe6ff1f537b37">num_vars_all_</a>, EigenSTL::vector_Vector3d(<a class="code" href="classchomp_1_1ChompOptimizer.html#ada498aefc4c6e9c5a9ee6e7b0b71fefc">num_joints_</a>));</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#a9af8690faea1fe76e6c953d3ad554b56">joint_positions_</a>.resize(<a class="code" href="classchomp_1_1ChompOptimizer.html#a10178cbef38ab61ec8efe6ff1f537b37">num_vars_all_</a>, EigenSTL::vector_Vector3d(<a class="code" href="classchomp_1_1ChompOptimizer.html#ada498aefc4c6e9c5a9ee6e7b0b71fefc">num_joints_</a>));</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#a4068aed1b38efd2f54b85b62960a7662">collision_point_potential_</a>.resize(<a class="code" href="classchomp_1_1ChompOptimizer.html#a10178cbef38ab61ec8efe6ff1f537b37">num_vars_all_</a>, std::vector&lt;double&gt;(<a class="code" href="classchomp_1_1ChompOptimizer.html#a5ec7779d032e89339c31556ef37f61f1">num_collision_points_</a>));</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#ac6696b62d069c117952aeca2b23de40a">collision_point_vel_mag_</a>.resize(<a class="code" href="classchomp_1_1ChompOptimizer.html#a10178cbef38ab61ec8efe6ff1f537b37">num_vars_all_</a>, std::vector&lt;double&gt;(<a class="code" href="classchomp_1_1ChompOptimizer.html#a5ec7779d032e89339c31556ef37f61f1">num_collision_points_</a>));</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#a5f7219b0c2f2eece57910cb22d9c7ef1">collision_point_potential_gradient_</a>.resize(<a class="code" href="classchomp_1_1ChompOptimizer.html#a10178cbef38ab61ec8efe6ff1f537b37">num_vars_all_</a>, EigenSTL::vector_Vector3d(<a class="code" href="classchomp_1_1ChompOptimizer.html#a5ec7779d032e89339c31556ef37f61f1">num_collision_points_</a>));</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#a7b74f22b7289e6c124db5aa0088731b9">collision_free_iteration_</a> = 0;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#ac115aaab6bcdf4ffc4bb3abbb7cc3320">is_collision_free_</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#a7eb2fa24e9cf2b0157b20d348a8cef86">state_is_in_collision_</a>.resize(<a class="code" href="classchomp_1_1ChompOptimizer.html#a10178cbef38ab61ec8efe6ff1f537b37">num_vars_all_</a>);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#afc9b1c126a4051a508d59a021b0315c2">point_is_in_collision_</a>.resize(<a class="code" href="classchomp_1_1ChompOptimizer.html#a10178cbef38ab61ec8efe6ff1f537b37">num_vars_all_</a>, std::vector&lt;int&gt;(<a class="code" href="classchomp_1_1ChompOptimizer.html#a5ec7779d032e89339c31556ef37f61f1">num_collision_points_</a>));</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#abc39cdc56e54ea91c6806d89021dccf9">last_improvement_iteration_</a> = -1;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="comment">// HMC initialization:</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="comment">// momentum_ = Eigen::MatrixXd::Zero(num_vars_free_, num_joints_);</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="comment">// random_momentum_ = Eigen::MatrixXd::Zero(num_vars_free_, num_joints_);</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="comment">// random_joint_momentum_ = Eigen::VectorXd::Zero(num_vars_free_);</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#ae68d937e3dc3a104132bebf9ad65cf92">multivariate_gaussian_</a>.clear();</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#a5aacf2b5248010ed35f1d654a5739918">stochasticity_factor_</a> = 1.0;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classchomp_1_1ChompOptimizer.html#ada498aefc4c6e9c5a9ee6e7b0b71fefc">num_joints_</a>; i++)</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <a class="code" href="classchomp_1_1ChompOptimizer.html#ae68d937e3dc3a104132bebf9ad65cf92">multivariate_gaussian_</a>.push_back(</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        MultivariateGaussian(Eigen::VectorXd::Zero(<a class="code" href="classchomp_1_1ChompOptimizer.html#a636d147684c72ba10b6eac8624ceb20b">num_vars_free_</a>), <a class="code" href="classchomp_1_1ChompOptimizer.html#ad522962453ef1b68c88b0d177e49add6">joint_costs_</a>[i].getQuadraticCostInverse()));</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  std::map&lt;std::string, std::string&gt; fixed_link_resolution_map;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classchomp_1_1ChompOptimizer.html#ada498aefc4c6e9c5a9ee6e7b0b71fefc">num_joints_</a>; i++)</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <a class="code" href="classchomp_1_1ChompOptimizer.html#ae5d0efa2d46c8d3ec261cab6a010ce8f">joint_names_</a>.push_back(<a class="code" href="classchomp_1_1ChompOptimizer.html#ac449fe23198404a23ccc12d45ad0a0cb">joint_model_group_</a>-&gt;getActiveJointModels()[i]-&gt;getName());</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="comment">// ROS_INFO(&quot;Got joint %s&quot;, joint_names_[i].c_str());</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <a class="code" href="classchomp_1_1ChompOptimizer.html#afee1f67cefc7f6e926bc13ae66389a48">registerParents</a>(<a class="code" href="classchomp_1_1ChompOptimizer.html#ac449fe23198404a23ccc12d45ad0a0cb">joint_model_group_</a>-&gt;getActiveJointModels()[i]);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    fixed_link_resolution_map[<a class="code" href="classchomp_1_1ChompOptimizer.html#ae5d0efa2d46c8d3ec261cab6a010ce8f">joint_names_</a>[i]] = <a class="code" href="classchomp_1_1ChompOptimizer.html#ae5d0efa2d46c8d3ec261cab6a010ce8f">joint_names_</a>[i];</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> moveit::core::JointModel* jm : <a class="code" href="classchomp_1_1ChompOptimizer.html#ac449fe23198404a23ccc12d45ad0a0cb">joint_model_group_</a>-&gt;getFixedJointModels())</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  {</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keywordflow">if</span> (!jm-&gt;getParentLinkModel())  <span class="comment">// root joint doesn&#39;t have a parent</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    fixed_link_resolution_map[jm-&gt;getName()] = jm-&gt;getParentLinkModel()-&gt;getParentJointModel()-&gt;getName();</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="comment">// TODO - is this just the joint_roots_?</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> moveit::core::LinkModel* link : <a class="code" href="classchomp_1_1ChompOptimizer.html#ac449fe23198404a23ccc12d45ad0a0cb">joint_model_group_</a>-&gt;getUpdatedLinkModels())</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordflow">if</span> (fixed_link_resolution_map.find(link-&gt;getParentJointModel()-&gt;getName()) == fixed_link_resolution_map.end())</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      <span class="keyword">const</span> moveit::core::JointModel* parent_model = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <span class="keywordtype">bool</span> found_root = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      <span class="keywordflow">while</span> (!found_root)</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <span class="keywordflow">if</span> (parent_model == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;          parent_model = link-&gt;getParentJointModel();</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;          parent_model = parent_model-&gt;getParentLinkModel()-&gt;getParentJointModel();</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">const</span> std::string&amp; joint_name : <a class="code" href="classchomp_1_1ChompOptimizer.html#ae5d0efa2d46c8d3ec261cab6a010ce8f">joint_names_</a>)</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;          {</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            <span class="keywordflow">if</span> (parent_model-&gt;getName() == joint_name)</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            {</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;              found_root = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;          }</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      }</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      fixed_link_resolution_map[link-&gt;getParentJointModel()-&gt;getName()] = parent_model-&gt;getName();</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="keywordtype">int</span> start = <a class="code" href="classchomp_1_1ChompOptimizer.html#ab2028b705c347074aef529a0c4a93534">free_vars_start_</a>;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keywordtype">int</span> end = <a class="code" href="classchomp_1_1ChompOptimizer.html#a9f4df819373a8fc4fc4c33bf3e61c3a2">free_vars_end_</a>;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = start; i &lt;= end; ++i)</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  {</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordtype">size_t</span> j = 0;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> collision_detection::GradientInfo&amp; info : <a class="code" href="classchomp_1_1ChompOptimizer.html#afbb9263fa4e62b19d6e8128cd57c477b">gsr_</a>-&gt;gradients_)</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> k = 0; k &lt; info.sphere_locations.size(); k++)</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="keywordflow">if</span> (fixed_link_resolution_map.find(info.joint_name) != fixed_link_resolution_map.end())</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;          <a class="code" href="classchomp_1_1ChompOptimizer.html#a70c367db1a30edc1cb3c97c4328749d2">collision_point_joint_names_</a>[i][j] = fixed_link_resolution_map[info.joint_name];</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        {</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;          ROS_ERROR(<span class="stringliteral">&quot;Couldn&#39;t find joint %s!&quot;</span>, info.joint_name.c_str());</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        }</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        j++;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      }</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    }</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  }</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#af2c89120550e89f097a5694b4484e610">initialized_</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;}</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<a class="code" href="classchomp_1_1ChompOptimizer.html#a2d645e404e612383fc506ac65935a88d">ChompOptimizer::~ChompOptimizer</a>()</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;{</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#a95e16eaf024162f644072f3f986b9e9b">destroy</a>();</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;}</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classchomp_1_1ChompOptimizer.html#afee1f67cefc7f6e926bc13ae66389a48">ChompOptimizer::registerParents</a>(<span class="keyword">const</span> moveit::core::JointModel* model)</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;{</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <span class="keyword">const</span> moveit::core::JointModel* parent_model = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <span class="keywordtype">bool</span> found_root = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="keywordflow">if</span> (model == <a class="code" href="classchomp_1_1ChompOptimizer.html#aa77c3cd6c65392e107c6aa732a0dd867">robot_model_</a>-&gt;getRootJoint())</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="keywordflow">while</span> (!found_root)</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  {</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordflow">if</span> (parent_model == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    {</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;      <span class="keywordflow">if</span> (model-&gt;getParentLinkModel() == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;      {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        ROS_ERROR_STREAM(<span class="stringliteral">&quot;Model &quot;</span> &lt;&lt; model-&gt;getName() &lt;&lt; <span class="stringliteral">&quot; not root but has NULL link model parent&quot;</span>);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      }</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (model-&gt;getParentLinkModel()-&gt;getParentJointModel() == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;      {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        ROS_ERROR_STREAM(<span class="stringliteral">&quot;Model &quot;</span> &lt;&lt; model-&gt;getName() &lt;&lt; <span class="stringliteral">&quot; not root but has NULL joint model parent&quot;</span>);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;      }</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      parent_model = model-&gt;getParentLinkModel()-&gt;getParentJointModel();</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    }</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      <span class="keywordflow">if</span> (parent_model == <a class="code" href="classchomp_1_1ChompOptimizer.html#aa77c3cd6c65392e107c6aa732a0dd867">robot_model_</a>-&gt;getRootJoint())</div>
<div class="line"><a name="l00292"></a><span class="lineno"><a class="line" href="classchomp_1_1ChompOptimizer.html#a2d645e404e612383fc506ac65935a88d">  292</a></span>&#160;      {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        found_root = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      }</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      {</div>
<div class="line"><a name="l00297"></a><span class="lineno"><a class="line" href="classchomp_1_1ChompOptimizer.html#afee1f67cefc7f6e926bc13ae66389a48">  297</a></span>&#160;        parent_model = parent_model-&gt;getParentLinkModel()-&gt;getParentJointModel();</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      }</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    }</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <a class="code" href="classchomp_1_1ChompOptimizer.html#ae25142ac19eff853f8e205c33c94d8f9">joint_parent_map_</a>[model-&gt;getName()][parent_model-&gt;getName()] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  }</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;}</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classchomp_1_1ChompOptimizer.html#a8bb956bcb8dbdc491c3339235cdec4a2">ChompOptimizer::optimize</a>()</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;{</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="keywordtype">bool</span> optimization_result = 0;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  ros::WallTime start_time = ros::WallTime::now();</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="comment">// double averageCostVelocity = 0.0;</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <span class="comment">// int currentCostIter = 0;</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  <span class="keywordtype">int</span> cost_window = 10;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  std::vector&lt;double&gt; costs(cost_window, 0.0);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="comment">// double minimaThreshold = 0.05;</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="keywordtype">bool</span> should_break_out = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="comment">// iterate</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="classchomp_1_1ChompOptimizer.html#aee94008b982c7fd677c6c2191e5bfd75">iteration_</a> = 0; <a class="code" href="classchomp_1_1ChompOptimizer.html#aee94008b982c7fd677c6c2191e5bfd75">iteration_</a> &lt; <a class="code" href="classchomp_1_1ChompOptimizer.html#a82519d9ad09cad7a441c19136db216bf">parameters_</a>-&gt;<a class="code" href="classchomp_1_1ChompParameters.html#aea2b23c848608c74ab3cfc768f103733">max_iterations_</a>; <a class="code" href="classchomp_1_1ChompOptimizer.html#aee94008b982c7fd677c6c2191e5bfd75">iteration_</a>++)</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    ros::WallTime for_time = ros::WallTime::now();</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <a class="code" href="classchomp_1_1ChompOptimizer.html#a1e7ec0f06f19405956b5dab1e63f2c74">performForwardKinematics</a>();</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    ROS_DEBUG_STREAM(<span class="stringliteral">&quot;Forward kinematics took &quot;</span> &lt;&lt; (ros::WallTime::now() - for_time));</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordtype">double</span> c_cost = <a class="code" href="classchomp_1_1ChompOptimizer.html#a45ee586e9c8e970059f81cc3b595d81f">getCollisionCost</a>();</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keywordtype">double</span> s_cost = <a class="code" href="classchomp_1_1ChompOptimizer.html#a34399fd4b1c32f1a43cac03ec531f455">getSmoothnessCost</a>();</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keywordtype">double</span> cost = c_cost + s_cost;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="comment">// ROS_INFO_STREAM(&quot;Collision cost &quot; &lt;&lt; cCost &lt;&lt; &quot; smoothness cost &quot; &lt;&lt; sCost);</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160; </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="comment">// if(parameters_-&gt;getAddRandomness() &amp;&amp; currentCostIter != -1)</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="comment">// {</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="comment">//   costs[currentCostIter] = cCost;</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="comment">//   currentCostIter++;</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160; </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="comment">//   if(currentCostIter &gt;= costWindow)</span></div>
<div class="line"><a name="l00336"></a><span class="lineno"><a class="line" href="classchomp_1_1ChompOptimizer.html#a8bb956bcb8dbdc491c3339235cdec4a2">  336</a></span>&#160;    <span class="comment">//   {</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="comment">//     for(int i = 1; i &lt; costWindow; i++)</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="comment">//     {</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="comment">//       averageCostVelocity += (costs.at(i) - costs.at(i - 1));</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="comment">//     }</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="comment">//     averageCostVelocity /= (double)(costWindow);</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="comment">//     currentCostIter = -1;</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="comment">//   }</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="comment">// }</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classchomp_1_1ChompOptimizer.html#aee94008b982c7fd677c6c2191e5bfd75">iteration_</a> == 0)</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      <a class="code" href="classchomp_1_1ChompOptimizer.html#a52c1ffa2020514e1da0dc51cfc607c02">best_group_trajectory_</a> = <a class="code" href="classchomp_1_1ChompOptimizer.html#ac8a33d22edb4dac95d88480f0b114ba1">group_trajectory_</a>.<a class="code" href="classchomp_1_1ChompTrajectory.html#ae0dc82cbaec33cbe55805e66264f7fc8">getTrajectory</a>();</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      <a class="code" href="classchomp_1_1ChompOptimizer.html#a290506c3d2fe5ea3f3b7ba24d5cf558a">best_group_trajectory_cost_</a> = cost;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      <a class="code" href="classchomp_1_1ChompOptimizer.html#abc39cdc56e54ea91c6806d89021dccf9">last_improvement_iteration_</a> = <a class="code" href="classchomp_1_1ChompOptimizer.html#aee94008b982c7fd677c6c2191e5bfd75">iteration_</a>;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    }</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cost &lt; <a class="code" href="classchomp_1_1ChompOptimizer.html#a290506c3d2fe5ea3f3b7ba24d5cf558a">best_group_trajectory_cost_</a>)</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    {</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      <a class="code" href="classchomp_1_1ChompOptimizer.html#a52c1ffa2020514e1da0dc51cfc607c02">best_group_trajectory_</a> = <a class="code" href="classchomp_1_1ChompOptimizer.html#ac8a33d22edb4dac95d88480f0b114ba1">group_trajectory_</a>.<a class="code" href="classchomp_1_1ChompTrajectory.html#ae0dc82cbaec33cbe55805e66264f7fc8">getTrajectory</a>();</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      <a class="code" href="classchomp_1_1ChompOptimizer.html#a290506c3d2fe5ea3f3b7ba24d5cf558a">best_group_trajectory_cost_</a> = cost;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      <a class="code" href="classchomp_1_1ChompOptimizer.html#abc39cdc56e54ea91c6806d89021dccf9">last_improvement_iteration_</a> = <a class="code" href="classchomp_1_1ChompOptimizer.html#aee94008b982c7fd677c6c2191e5bfd75">iteration_</a>;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    }</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <a class="code" href="classchomp_1_1ChompOptimizer.html#a9e29afcf3f2c7a6e4eebe6c5f9d5f82f">calculateSmoothnessIncrements</a>();</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <a class="code" href="classchomp_1_1ChompOptimizer.html#a58b03cf2a0276ed687f285dbfe3498e3">calculateCollisionIncrements</a>();</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <a class="code" href="classchomp_1_1ChompOptimizer.html#aa0a834c7c08af9c552178ae30ccc1673">calculateTotalIncrements</a>();</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="comment">// if(!parameters_-&gt;getUseHamiltonianMonteCarlo())</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="comment">// {</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="comment">//   // non-stochastic version:</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <a class="code" href="classchomp_1_1ChompOptimizer.html#a2db6515a66d055215071b41514c4936e">addIncrementsToTrajectory</a>();</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="comment">// }</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="comment">// else</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="comment">// {</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    <span class="comment">//   // hamiltonian monte carlo updates:</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="comment">//   getRandomMomentum();</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="comment">//   updateMomentum();</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="comment">//   updatePositionFromMomentum();</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="comment">//   stochasticity_factor_ *= parameters_-&gt;getHmcAnnealingFactor();</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="comment">// }</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <a class="code" href="classchomp_1_1ChompOptimizer.html#a836de9ad21ca36219b237be668376969">handleJointLimits</a>();</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <a class="code" href="classchomp_1_1ChompOptimizer.html#a16b9649944d27ac194464763f1c381a5">updateFullTrajectory</a>();</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160; </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classchomp_1_1ChompOptimizer.html#aee94008b982c7fd677c6c2191e5bfd75">iteration_</a> % 10 == 0)</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    {</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      ROS_INFO(<span class="stringliteral">&quot;iteration: %d&quot;</span>, <a class="code" href="classchomp_1_1ChompOptimizer.html#aee94008b982c7fd677c6c2191e5bfd75">iteration_</a>);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classchomp_1_1ChompOptimizer.html#a41dcf0f0ada22bc19c4aee890f5cc751">isCurrentTrajectoryMeshToMeshCollisionFree</a>())</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      {</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <a class="code" href="classchomp_1_1ChompOptimizer.html#a4d092cc008b0cf9bd47971fee55f30ca">num_collision_free_iterations_</a> = 0;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        ROS_INFO(<span class="stringliteral">&quot;Chomp Got mesh to mesh safety at iter %d. Breaking out early.&quot;</span>, <a class="code" href="classchomp_1_1ChompOptimizer.html#aee94008b982c7fd677c6c2191e5bfd75">iteration_</a>);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <a class="code" href="classchomp_1_1ChompOptimizer.html#ac115aaab6bcdf4ffc4bb3abbb7cc3320">is_collision_free_</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;        <a class="code" href="classchomp_1_1ChompOptimizer.html#aee94008b982c7fd677c6c2191e5bfd75">iteration_</a>++;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        should_break_out = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      }</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      <span class="comment">// } else if(safety == CollisionProximitySpace::InCollisionSafe) {</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160; </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      <span class="comment">// ROS_DEBUG(&quot;Trajectory cost: %f (s=%f, c=%f)&quot;, getTrajectoryCost(), getSmoothnessCost(), getCollisionCost());</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      <span class="comment">// CollisionProximitySpace::TrajectorySafety safety = checkCurrentIterValidity();</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      <span class="comment">// if(safety == CollisionProximitySpace::MeshToMeshSafe)</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      <span class="comment">// {</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      <span class="comment">//   num_collision_free_iterations_ = 0;</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      <span class="comment">//   ROS_INFO(&quot;Chomp Got mesh to mesh safety at iter %d. Breaking out early.&quot;, iteration_);</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      <span class="comment">//   is_collision_free_ = true;</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      <span class="comment">//   iteration_++;</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      <span class="comment">//   should_break_out = true;</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      <span class="comment">// } else if(safety == CollisionProximitySpace::InCollisionSafe) {</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      <span class="comment">//   num_collision_free_iterations_ = parameters_-&gt;getMaxIterationsAfterCollisionFree();</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      <span class="comment">//   ROS_INFO(&quot;Chomp Got in collision safety at iter %d. Breaking out soon.&quot;, iteration_);</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      <span class="comment">//   is_collision_free_ = true;</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      <span class="comment">//   iteration_++;</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      <span class="comment">//   should_break_out = true;</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      <span class="comment">// }</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;      <span class="comment">// else</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      <span class="comment">// {</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      <span class="comment">//   is_collision_free_ = false;</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      <span class="comment">// }</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    }</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classchomp_1_1ChompOptimizer.html#a82519d9ad09cad7a441c19136db216bf">parameters_</a>-&gt;<a class="code" href="classchomp_1_1ChompParameters.html#a7687a2bc613fe773c56974072a7b257e">filter_mode_</a>)</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    {</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      <span class="keywordflow">if</span> (c_cost &lt; parameters_-&gt;collision_threshold_)</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      {</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <a class="code" href="classchomp_1_1ChompOptimizer.html#a4d092cc008b0cf9bd47971fee55f30ca">num_collision_free_iterations_</a> = <a class="code" href="classchomp_1_1ChompOptimizer.html#a82519d9ad09cad7a441c19136db216bf">parameters_</a>-&gt;<a class="code" href="classchomp_1_1ChompParameters.html#ad429eeecfa51f163373e5f89a8593d11">max_iterations_after_collision_free_</a>;</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <a class="code" href="classchomp_1_1ChompOptimizer.html#ac115aaab6bcdf4ffc4bb3abbb7cc3320">is_collision_free_</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        <a class="code" href="classchomp_1_1ChompOptimizer.html#aee94008b982c7fd677c6c2191e5bfd75">iteration_</a>++;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        should_break_out = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      }</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      {</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <span class="comment">// ROS_INFO_STREAM(&quot;cCost &quot; &lt;&lt; cCost &lt;&lt; &quot; over threshold &quot; &lt;&lt; parameters_-&gt;getCollisionThreshold());</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      }</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    }</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160; </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <span class="keywordflow">if</span> ((ros::WallTime::now() - start_time).toSec() &gt; <a class="code" href="classchomp_1_1ChompOptimizer.html#a82519d9ad09cad7a441c19136db216bf">parameters_</a>-&gt;<a class="code" href="classchomp_1_1ChompParameters.html#a057028f02f3a2314a57351221b17b8c6">planning_time_limit_</a>)</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    {</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      ROS_WARN(<span class="stringliteral">&quot;Breaking out early due to time limit constraints.&quot;</span>);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    }</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160; </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160; </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="comment">// if(fabs(averageCostVelocity) &lt; minimaThreshold &amp;&amp; currentCostIter == -1 &amp;&amp; !is_collision_free_ &amp;&amp;</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="comment">// parameters_-&gt;getAddRandomness())</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="comment">// {</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    <span class="comment">//   ROS_INFO(&quot;Detected local minima. Attempting to break out!&quot;);</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="comment">//   int iter = 0;</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="comment">//   bool success = false;</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="comment">//   while(iter &lt; 20 &amp;&amp; !success)</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="comment">//   {</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    <span class="comment">//     performForwardKinematics();</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="comment">//     double original_cost = getTrajectoryCost();</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="comment">//     group_trajectory_backup_ = group_trajectory_.getTrajectory();</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="comment">//     perturbTrajectory();</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="comment">//     handleJointLimits();</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="comment">//     updateFullTrajectory();</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="comment">//     performForwardKinematics();</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="comment">//     double new_cost = getTrajectoryCost();</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="comment">//     iter ++;</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="comment">//     if(new_cost &lt; original_cost)</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="comment">//     {</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="comment">//       ROS_INFO(&quot;Got out of minimum in %d iters!&quot;, iter);</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="comment">//       averageCostVelocity = 0.0;</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="comment">//       currentCostIter = 0;</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="comment">//       success = true;</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="comment">//     }</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="comment">//     else</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="comment">//     {</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="comment">//       group_trajectory_.getTrajectory() = group_trajectory_backup_;</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="comment">//       updateFullTrajectory();</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="comment">//       currentCostIter = 0;</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="comment">//       averageCostVelocity = 0.0;</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="comment">//       success = false;</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="comment">//     }</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="comment">//   }</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160; </div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="comment">//   if(!success)</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="comment">//   {</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="comment">//     ROS_INFO(&quot;Failed to exit minimum!&quot;);</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="comment">//   }</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="comment">//}</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="comment">// else if (currentCostIter == -1)</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="comment">//{</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="comment">//  currentCostIter = 0;</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="comment">//  averageCostVelocity = 0.0;</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="comment">//}</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160; </div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="keywordflow">if</span> (should_break_out)</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    {</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      <a class="code" href="classchomp_1_1ChompOptimizer.html#a7b74f22b7289e6c124db5aa0088731b9">collision_free_iteration_</a>++;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classchomp_1_1ChompOptimizer.html#a4d092cc008b0cf9bd47971fee55f30ca">num_collision_free_iterations_</a> == 0)</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      {</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;      }</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classchomp_1_1ChompOptimizer.html#a7b74f22b7289e6c124db5aa0088731b9">collision_free_iteration_</a> &gt; <a class="code" href="classchomp_1_1ChompOptimizer.html#a4d092cc008b0cf9bd47971fee55f30ca">num_collision_free_iterations_</a>)</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      {</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <span class="comment">// CollisionProximitySpace::TrajectorySafety safety = checkCurrentIterValidity();</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <span class="comment">// if(safety != CollisionProximitySpace::MeshToMeshSafe &amp;&amp;</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        <span class="comment">//    safety != CollisionProximitySpace::InCollisionSafe) {</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        <span class="comment">//   ROS_WARN_STREAM(&quot;Apparently regressed&quot;);</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <span class="comment">// }</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      }</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    }</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;  }</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160; </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classchomp_1_1ChompOptimizer.html#ac115aaab6bcdf4ffc4bb3abbb7cc3320">is_collision_free_</a>)</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;  {</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    optimization_result = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    ROS_INFO(<span class="stringliteral">&quot;Chomp path is collision free&quot;</span>);</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;  }</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  {</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    optimization_result = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    ROS_ERROR(<span class="stringliteral">&quot;Chomp path is not collision free!&quot;</span>);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  }</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#ac8a33d22edb4dac95d88480f0b114ba1">group_trajectory_</a>.<a class="code" href="classchomp_1_1ChompTrajectory.html#ae0dc82cbaec33cbe55805e66264f7fc8">getTrajectory</a>() = <a class="code" href="classchomp_1_1ChompOptimizer.html#a52c1ffa2020514e1da0dc51cfc607c02">best_group_trajectory_</a>;</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#a16b9649944d27ac194464763f1c381a5">updateFullTrajectory</a>();</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160; </div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;  ROS_INFO(<span class="stringliteral">&quot;Terminated after %d iterations, using path from iteration %d&quot;</span>, <a class="code" href="classchomp_1_1ChompOptimizer.html#aee94008b982c7fd677c6c2191e5bfd75">iteration_</a>, <a class="code" href="classchomp_1_1ChompOptimizer.html#abc39cdc56e54ea91c6806d89021dccf9">last_improvement_iteration_</a>);</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  ROS_INFO(<span class="stringliteral">&quot;Optimization core finished in %f sec&quot;</span>, (ros::WallTime::now() - start_time).toSec());</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  ROS_INFO_STREAM(<span class="stringliteral">&quot;Time per iteration &quot;</span> &lt;&lt; (ros::WallTime::now() - start_time).toSec() / (<a class="code" href="classchomp_1_1ChompOptimizer.html#aee94008b982c7fd677c6c2191e5bfd75">iteration_</a> * 1.0));</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160; </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  <span class="keywordflow">return</span> optimization_result;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;}</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160; </div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="keywordtype">bool</span> <a class="code" href="classchomp_1_1ChompOptimizer.html#a41dcf0f0ada22bc19c4aee890f5cc751">ChompOptimizer::isCurrentTrajectoryMeshToMeshCollisionFree</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  moveit_msgs::RobotTrajectory traj;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  traj.joint_trajectory.joint_names = <a class="code" href="classchomp_1_1ChompOptimizer.html#ae5d0efa2d46c8d3ec261cab6a010ce8f">joint_names_</a>;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160; </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; <a class="code" href="classchomp_1_1ChompOptimizer.html#ac8a33d22edb4dac95d88480f0b114ba1">group_trajectory_</a>.<a class="code" href="classchomp_1_1ChompTrajectory.html#a61bca7c981f6f94adaee9703828d34ff">getNumPoints</a>(); i++)</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  {</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    trajectory_msgs::JointTrajectoryPoint point;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; <a class="code" href="classchomp_1_1ChompOptimizer.html#ac8a33d22edb4dac95d88480f0b114ba1">group_trajectory_</a>.<a class="code" href="classchomp_1_1ChompTrajectory.html#a972938a9774b1e0654d56ed7dd7da0e9">getNumJoints</a>(); j++)</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    {</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      point.positions.push_back(<a class="code" href="classchomp_1_1ChompOptimizer.html#a52c1ffa2020514e1da0dc51cfc607c02">best_group_trajectory_</a>(i, j));</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    }</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    traj.joint_trajectory.points.push_back(point);</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  }</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  moveit_msgs::RobotState start_state_msg;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  moveit::core::robotStateToRobotStateMsg(<a class="code" href="classchomp_1_1ChompOptimizer.html#ab1d91bec80485ee143fd1e8a37004100">start_state_</a>, start_state_msg);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classchomp_1_1ChompOptimizer.html#a45348d687e33567bade08b7c7d54f35a">planning_scene_</a>-&gt;isPathValid(start_state_msg, traj, <a class="code" href="classchomp_1_1ChompOptimizer.html#a0bf78e07c502c4a51d2f87ea4762e622">planning_group_</a>);</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;}</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160; </div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160; </div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment">// CollisionProximitySpace::TrajectorySafety ChompOptimizer::checkCurrentIterValidity()</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment">// {</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">//   JointTrajectory jointTrajectory;</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">//   jointTrajectory.joint_names = joint_names_;</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment">//   jointTrajectory.header.frame_id = collision_space_-&gt;getCollisionModelsInterface()-&gt;getRobotFrameId();</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">//   jointTrajectory.header.stamp = ros::Time::now();</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">//   Constraints goalConstraints;</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">//   Constraints pathConstraints;</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">//   ArmNavigationErrorCodes errorCode;</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">//   vector&lt;ArmNavigationErrorCodes&gt; trajectoryErrorCodes;</span></div>
<div class="line"><a name="l00563"></a><span class="lineno"><a class="line" href="classchomp_1_1ChompOptimizer.html#a41dcf0f0ada22bc19c4aee890f5cc751">  563</a></span>&#160;<span class="comment">//   for(int i = 0; i &lt; group_trajectory_.getNumPoints(); i++)</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">//   {</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">//     JointTrajectoryPoint point;</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment">//     for(int j = 0; j &lt; group_trajectory_.getNumJoints(); j++)</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">//     {</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">//       point.positions.push_back(best_group_trajectory_(i, j));</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">//     }</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">//     jointTrajectory.points.push_back(point);</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">//   }</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160; </div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment">//   return collision_space_-&gt;isTrajectorySafe(jointTrajectory, goalConstraints, pathConstraints, planning_group_);</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment">//   /*</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment">//     bool valid = collision_space_-&gt;getCollisionModelsInterface()-&gt;isJointTrajectoryValid(*state_,</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment">//     jointTrajectory,</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment">//     goalConstraints,</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment">//     pathConstraints, errorCode,</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">//     trajectoryErrorCodes, false);</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">//   */</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">// }</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160; </div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classchomp_1_1ChompOptimizer.html#a9e29afcf3f2c7a6e4eebe6c5f9d5f82f">ChompOptimizer::calculateSmoothnessIncrements</a>()</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;{</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classchomp_1_1ChompOptimizer.html#ada498aefc4c6e9c5a9ee6e7b0b71fefc">num_joints_</a>; i++)</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  {</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <a class="code" href="classchomp_1_1ChompOptimizer.html#ad522962453ef1b68c88b0d177e49add6">joint_costs_</a>[i].getDerivative(<a class="code" href="classchomp_1_1ChompOptimizer.html#ac8a33d22edb4dac95d88480f0b114ba1">group_trajectory_</a>.<a class="code" href="classchomp_1_1ChompTrajectory.html#ac4a59a86e9afc0616d9ee44a6440d348">getJointTrajectory</a>(i), <a class="code" href="classchomp_1_1ChompOptimizer.html#a06fd3548c17ad7e728a7d1e6b9394bdd">smoothness_derivative_</a>);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <a class="code" href="classchomp_1_1ChompOptimizer.html#a0ac29189993f328f89f8fcec04d640ea">smoothness_increments_</a>.col(i) = -<a class="code" href="classchomp_1_1ChompOptimizer.html#a06fd3548c17ad7e728a7d1e6b9394bdd">smoothness_derivative_</a>.segment(<a class="code" href="classchomp_1_1ChompOptimizer.html#ac8a33d22edb4dac95d88480f0b114ba1">group_trajectory_</a>.<a class="code" href="classchomp_1_1ChompTrajectory.html#a46b4d7d90712373552677264d74701be">getStartIndex</a>(), <a class="code" href="classchomp_1_1ChompOptimizer.html#a636d147684c72ba10b6eac8624ceb20b">num_vars_free_</a>);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  }</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;}</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160; </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classchomp_1_1ChompOptimizer.html#a58b03cf2a0276ed687f285dbfe3498e3">ChompOptimizer::calculateCollisionIncrements</a>()</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;{</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <span class="keywordtype">double</span> potential;</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <span class="keywordtype">double</span> vel_mag_sq;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  <span class="keywordtype">double</span> vel_mag;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  Eigen::Vector3d potential_gradient;</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  Eigen::Vector3d normalized_velocity;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  Eigen::Matrix3d orthogonal_projector;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  Eigen::Vector3d curvature_vector;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  Eigen::Vector3d cartesian_gradient;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160; </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#a8de144c16b30bdb83c47c8b3ed84517f">collision_increments_</a>.setZero(<a class="code" href="classchomp_1_1ChompOptimizer.html#a636d147684c72ba10b6eac8624ceb20b">num_vars_free_</a>, <a class="code" href="classchomp_1_1ChompOptimizer.html#ada498aefc4c6e9c5a9ee6e7b0b71fefc">num_joints_</a>);</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160; </div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  <span class="keywordtype">int</span> start_point = 0;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <span class="keywordtype">int</span> end_point = <a class="code" href="classchomp_1_1ChompOptimizer.html#a9f4df819373a8fc4fc4c33bf3e61c3a2">free_vars_end_</a>;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160; </div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  <span class="comment">// In stochastic descent, simply use a random point in the trajectory, rather than all the trajectory points.</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  <span class="comment">// This is faster and guaranteed to converge, but it may take more iterations in the worst case.</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classchomp_1_1ChompOptimizer.html#a82519d9ad09cad7a441c19136db216bf">parameters_</a>-&gt;<a class="code" href="classchomp_1_1ChompParameters.html#a720d0351b9f2c20f27493c00a3a3173a">use_stochastic_descent_</a>)</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  {</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    start_point = (int)(<a class="code" href="namespacechomp.html#a3cb4d6d2179e5505bce99ccf70e4b61e">getRandomDouble</a>() * (<a class="code" href="classchomp_1_1ChompOptimizer.html#a9f4df819373a8fc4fc4c33bf3e61c3a2">free_vars_end_</a> - <a class="code" href="classchomp_1_1ChompOptimizer.html#ab2028b705c347074aef529a0c4a93534">free_vars_start_</a>) + <a class="code" href="classchomp_1_1ChompOptimizer.html#ab2028b705c347074aef529a0c4a93534">free_vars_start_</a>);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="keywordflow">if</span> (start_point &lt; <a class="code" href="classchomp_1_1ChompOptimizer.html#ab2028b705c347074aef529a0c4a93534">free_vars_start_</a>)</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;      start_point = <a class="code" href="classchomp_1_1ChompOptimizer.html#ab2028b705c347074aef529a0c4a93534">free_vars_start_</a>;</div>
<div class="line"><a name="l00616"></a><span class="lineno"><a class="line" href="classchomp_1_1ChompOptimizer.html#a9e29afcf3f2c7a6e4eebe6c5f9d5f82f">  616</a></span>&#160;    <span class="keywordflow">if</span> (start_point &gt; <a class="code" href="classchomp_1_1ChompOptimizer.html#a9f4df819373a8fc4fc4c33bf3e61c3a2">free_vars_end_</a>)</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      start_point = <a class="code" href="classchomp_1_1ChompOptimizer.html#a9f4df819373a8fc4fc4c33bf3e61c3a2">free_vars_end_</a>;</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    end_point = start_point;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  }</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  {</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    start_point = <a class="code" href="classchomp_1_1ChompOptimizer.html#ab2028b705c347074aef529a0c4a93534">free_vars_start_</a>;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  }</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160; </div>
<div class="line"><a name="l00625"></a><span class="lineno"><a class="line" href="classchomp_1_1ChompOptimizer.html#a58b03cf2a0276ed687f285dbfe3498e3">  625</a></span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = start_point; i &lt;= end_point; i++)</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  {</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classchomp_1_1ChompOptimizer.html#a5ec7779d032e89339c31556ef37f61f1">num_collision_points_</a>; j++)</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    {</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      potential = <a class="code" href="classchomp_1_1ChompOptimizer.html#a4068aed1b38efd2f54b85b62960a7662">collision_point_potential_</a>[i][j];</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160; </div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      <span class="keywordflow">if</span> (potential &lt; 0.0001)</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160; </div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      potential_gradient = -<a class="code" href="classchomp_1_1ChompOptimizer.html#a5f7219b0c2f2eece57910cb22d9c7ef1">collision_point_potential_gradient_</a>[i][j];</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160; </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;      vel_mag = <a class="code" href="classchomp_1_1ChompOptimizer.html#ac6696b62d069c117952aeca2b23de40a">collision_point_vel_mag_</a>[i][j];</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      vel_mag_sq = vel_mag * vel_mag;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160; </div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;      <span class="comment">// all math from the CHOMP paper:</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160; </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;      normalized_velocity = <a class="code" href="classchomp_1_1ChompOptimizer.html#a18cc68cc4fd817ebf5f5e51297a8e7e8">collision_point_vel_eigen_</a>[i][j] / vel_mag;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;      orthogonal_projector = Eigen::Matrix3d::Identity() - (normalized_velocity * normalized_velocity.transpose());</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;      curvature_vector = (orthogonal_projector * <a class="code" href="classchomp_1_1ChompOptimizer.html#a8c1ece38b849b164289f5753945f3c95">collision_point_acc_eigen_</a>[i][j]) / vel_mag_sq;</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      cartesian_gradient = vel_mag * (orthogonal_projector * potential_gradient - potential * curvature_vector);</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160; </div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      <span class="comment">// pass it through the jacobian transpose to get the increments</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      <a class="code" href="classchomp_1_1ChompOptimizer.html#a4b4034539ad534476cadce76a3327e04">getJacobian</a>(i, <a class="code" href="classchomp_1_1ChompOptimizer.html#abe45133eaaa4dfbc2224abaa25a5f7e1">collision_point_pos_eigen_</a>[i][j], <a class="code" href="classchomp_1_1ChompOptimizer.html#a70c367db1a30edc1cb3c97c4328749d2">collision_point_joint_names_</a>[i][j], <a class="code" href="classchomp_1_1ChompOptimizer.html#a630a1c0d5720867f82d83e16b2d43778">jacobian_</a>);</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160; </div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classchomp_1_1ChompOptimizer.html#a82519d9ad09cad7a441c19136db216bf">parameters_</a>-&gt;<a class="code" href="classchomp_1_1ChompParameters.html#a4b2be5cb20227e77576b5243f57d9522">use_pseudo_inverse_</a>)</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;      {</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        <a class="code" href="classchomp_1_1ChompOptimizer.html#aa1ace51000e0432ef922b5ad7bd25bda">calculatePseudoInverse</a>();</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        <a class="code" href="classchomp_1_1ChompOptimizer.html#a8de144c16b30bdb83c47c8b3ed84517f">collision_increments_</a>.row(i - <a class="code" href="classchomp_1_1ChompOptimizer.html#ab2028b705c347074aef529a0c4a93534">free_vars_start_</a>).transpose() -= <a class="code" href="classchomp_1_1ChompOptimizer.html#a9e5a7b8bd8a882869725e42e92237ba7">jacobian_pseudo_inverse_</a> * cartesian_gradient;</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;      }</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;      {</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        <a class="code" href="classchomp_1_1ChompOptimizer.html#a8de144c16b30bdb83c47c8b3ed84517f">collision_increments_</a>.row(i - <a class="code" href="classchomp_1_1ChompOptimizer.html#ab2028b705c347074aef529a0c4a93534">free_vars_start_</a>).transpose() -= <a class="code" href="classchomp_1_1ChompOptimizer.html#a630a1c0d5720867f82d83e16b2d43778">jacobian_</a>.transpose() * cartesian_gradient;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;      }</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160; </div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;      <span class="comment">/*</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment">        if(point_is_in_collision_[i][j])</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="comment">        {</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="comment">        break;</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="comment">        }</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment">      */</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    }</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  }</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  <span class="comment">// cout &lt;&lt; collision_increments_ &lt;&lt; endl;</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;}</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160; </div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classchomp_1_1ChompOptimizer.html#aa1ace51000e0432ef922b5ad7bd25bda">ChompOptimizer::calculatePseudoInverse</a>()</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;{</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#aacf642cdbcedc4e4ac82519aa09767ea">jacobian_jacobian_tranpose_</a> =</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      <a class="code" href="classchomp_1_1ChompOptimizer.html#a630a1c0d5720867f82d83e16b2d43778">jacobian_</a> * <a class="code" href="classchomp_1_1ChompOptimizer.html#a630a1c0d5720867f82d83e16b2d43778">jacobian_</a>.transpose() + Eigen::MatrixXd::Identity(3, 3) * <a class="code" href="classchomp_1_1ChompOptimizer.html#a82519d9ad09cad7a441c19136db216bf">parameters_</a>-&gt;<a class="code" href="classchomp_1_1ChompParameters.html#a76bb5c0214818b278cf5525b8e11f4b2">pseudo_inverse_ridge_factor_</a>;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#a9e5a7b8bd8a882869725e42e92237ba7">jacobian_pseudo_inverse_</a> = <a class="code" href="classchomp_1_1ChompOptimizer.html#a630a1c0d5720867f82d83e16b2d43778">jacobian_</a>.transpose() * <a class="code" href="classchomp_1_1ChompOptimizer.html#aacf642cdbcedc4e4ac82519aa09767ea">jacobian_jacobian_tranpose_</a>.inverse();</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;}</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160; </div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classchomp_1_1ChompOptimizer.html#aa0a834c7c08af9c552178ae30ccc1673">ChompOptimizer::calculateTotalIncrements</a>()</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;{</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classchomp_1_1ChompOptimizer.html#ada498aefc4c6e9c5a9ee6e7b0b71fefc">num_joints_</a>; i++)</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  {</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <a class="code" href="classchomp_1_1ChompOptimizer.html#a4fe49a4b1890b27815319f947cb30cf9">final_increments_</a>.col(i) =</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        <a class="code" href="classchomp_1_1ChompOptimizer.html#a82519d9ad09cad7a441c19136db216bf">parameters_</a>-&gt;<a class="code" href="classchomp_1_1ChompParameters.html#af603e620498d300bde1159e4edd3981c">learning_rate_</a> * (<a class="code" href="classchomp_1_1ChompOptimizer.html#ad522962453ef1b68c88b0d177e49add6">joint_costs_</a>[i].getQuadraticCostInverse() *</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                                       (<a class="code" href="classchomp_1_1ChompOptimizer.html#a82519d9ad09cad7a441c19136db216bf">parameters_</a>-&gt;<a class="code" href="classchomp_1_1ChompParameters.html#a193442a77a13bcd514d1df43d6594ab5">smoothness_cost_weight_</a> * <a class="code" href="classchomp_1_1ChompOptimizer.html#a0ac29189993f328f89f8fcec04d640ea">smoothness_increments_</a>.col(i) +</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                                        <a class="code" href="classchomp_1_1ChompOptimizer.html#a82519d9ad09cad7a441c19136db216bf">parameters_</a>-&gt;<a class="code" href="classchomp_1_1ChompParameters.html#aeec8f058d69671792f96c7fa0017e065">obstacle_cost_weight_</a> * <a class="code" href="classchomp_1_1ChompOptimizer.html#a8de144c16b30bdb83c47c8b3ed84517f">collision_increments_</a>.col(i)));</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  }</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;}</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160; </div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classchomp_1_1ChompOptimizer.html#a2db6515a66d055215071b41514c4936e">ChompOptimizer::addIncrementsToTrajectory</a>()</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;{</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  <span class="keyword">const</span> std::vector&lt;const moveit::core::JointModel*&gt;&amp; joint_models = <a class="code" href="classchomp_1_1ChompOptimizer.html#ac449fe23198404a23ccc12d45ad0a0cb">joint_model_group_</a>-&gt;getActiveJointModels();</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; joint_models.size(); i++)</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  {</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    <span class="keywordtype">double</span> scale = 1.0;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="keywordtype">double</span> max = <a class="code" href="classchomp_1_1ChompOptimizer.html#a4fe49a4b1890b27815319f947cb30cf9">final_increments_</a>.col(i).maxCoeff();</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="keywordtype">double</span> min = <a class="code" href="classchomp_1_1ChompOptimizer.html#a4fe49a4b1890b27815319f947cb30cf9">final_increments_</a>.col(i).minCoeff();</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="keywordtype">double</span> max_scale = <a class="code" href="classchomp_1_1ChompOptimizer.html#a82519d9ad09cad7a441c19136db216bf">parameters_</a>-&gt;<a class="code" href="classchomp_1_1ChompParameters.html#ae03aabba1ced49e6f9dbbdd287adb02d">joint_update_limit_</a> / fabs(max);</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    <span class="keywordtype">double</span> min_scale = <a class="code" href="classchomp_1_1ChompOptimizer.html#a82519d9ad09cad7a441c19136db216bf">parameters_</a>-&gt;<a class="code" href="classchomp_1_1ChompParameters.html#ae03aabba1ced49e6f9dbbdd287adb02d">joint_update_limit_</a> / fabs(min);</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    <span class="keywordflow">if</span> (max_scale &lt; scale)</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;      scale = max_scale;</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="keywordflow">if</span> (min_scale &lt; scale)</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;      scale = min_scale;</div>
<div class="line"><a name="l00702"></a><span class="lineno"><a class="line" href="classchomp_1_1ChompOptimizer.html#aa1ace51000e0432ef922b5ad7bd25bda">  702</a></span>&#160;    <a class="code" href="classchomp_1_1ChompOptimizer.html#ac8a33d22edb4dac95d88480f0b114ba1">group_trajectory_</a>.<a class="code" href="classchomp_1_1ChompTrajectory.html#a0e2396f83d3e6e93da03c01022f296c3">getFreeTrajectoryBlock</a>().col(i) += scale * <a class="code" href="classchomp_1_1ChompOptimizer.html#a4fe49a4b1890b27815319f947cb30cf9">final_increments_</a>.col(i);</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  }</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;  <span class="comment">// ROS_DEBUG(&quot;Scale: %f&quot;,scale);</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;  <span class="comment">// group_trajectory_.getFreeTrajectoryBlock() += scale * final_increments_;</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;}</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160; </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classchomp_1_1ChompOptimizer.html#a16b9649944d27ac194464763f1c381a5">ChompOptimizer::updateFullTrajectory</a>()</div>
<div class="line"><a name="l00709"></a><span class="lineno"><a class="line" href="classchomp_1_1ChompOptimizer.html#aa0a834c7c08af9c552178ae30ccc1673">  709</a></span>&#160;{</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#a3eeaf83e4d84b829c91d597d235e2805">full_trajectory_</a>-&gt;<a class="code" href="classchomp_1_1ChompTrajectory.html#a4492f077e039ff75bf4a62f678242898">updateFromGroupTrajectory</a>(<a class="code" href="classchomp_1_1ChompOptimizer.html#ac8a33d22edb4dac95d88480f0b114ba1">group_trajectory_</a>);</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;}</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160; </div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classchomp_1_1ChompOptimizer.html#a15f03bdad314356db449de130f9be5e8">ChompOptimizer::debugCost</a>()</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;{</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  <span class="keywordtype">double</span> cost = 0.0;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classchomp_1_1ChompOptimizer.html#ada498aefc4c6e9c5a9ee6e7b0b71fefc">num_joints_</a>; i++)</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    cost += <a class="code" href="classchomp_1_1ChompOptimizer.html#ad522962453ef1b68c88b0d177e49add6">joint_costs_</a>[i].getCost(<a class="code" href="classchomp_1_1ChompOptimizer.html#ac8a33d22edb4dac95d88480f0b114ba1">group_trajectory_</a>.<a class="code" href="classchomp_1_1ChompTrajectory.html#ac4a59a86e9afc0616d9ee44a6440d348">getJointTrajectory</a>(i));</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  std::cout &lt;&lt; <span class="stringliteral">&quot;Cost = &quot;</span> &lt;&lt; cost &lt;&lt; std::endl;</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;}</div>
<div class="line"><a name="l00720"></a><span class="lineno"><a class="line" href="classchomp_1_1ChompOptimizer.html#a2db6515a66d055215071b41514c4936e">  720</a></span>&#160; </div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="keywordtype">double</span> <a class="code" href="classchomp_1_1ChompOptimizer.html#a5b8fb75a78691f2ccfd19fbad87027d6">ChompOptimizer::getTrajectoryCost</a>()</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;{</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classchomp_1_1ChompOptimizer.html#a34399fd4b1c32f1a43cac03ec531f455">getSmoothnessCost</a>() + <a class="code" href="classchomp_1_1ChompOptimizer.html#a45ee586e9c8e970059f81cc3b595d81f">getCollisionCost</a>();</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;}</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160; </div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="keywordtype">double</span> <a class="code" href="classchomp_1_1ChompOptimizer.html#a34399fd4b1c32f1a43cac03ec531f455">ChompOptimizer::getSmoothnessCost</a>()</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;{</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  <span class="keywordtype">double</span> smoothness_cost = 0.0;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  <span class="comment">// joint costs:</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classchomp_1_1ChompOptimizer.html#ada498aefc4c6e9c5a9ee6e7b0b71fefc">num_joints_</a>; i++)</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    smoothness_cost += <a class="code" href="classchomp_1_1ChompOptimizer.html#ad522962453ef1b68c88b0d177e49add6">joint_costs_</a>[i].getCost(<a class="code" href="classchomp_1_1ChompOptimizer.html#ac8a33d22edb4dac95d88480f0b114ba1">group_trajectory_</a>.<a class="code" href="classchomp_1_1ChompTrajectory.html#ac4a59a86e9afc0616d9ee44a6440d348">getJointTrajectory</a>(i));</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160; </div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classchomp_1_1ChompOptimizer.html#a82519d9ad09cad7a441c19136db216bf">parameters_</a>-&gt;<a class="code" href="classchomp_1_1ChompParameters.html#a193442a77a13bcd514d1df43d6594ab5">smoothness_cost_weight_</a> * smoothness_cost;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;}</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160; </div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="keywordtype">double</span> <a class="code" href="classchomp_1_1ChompOptimizer.html#a45ee586e9c8e970059f81cc3b595d81f">ChompOptimizer::getCollisionCost</a>()</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;{</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <span class="keywordtype">double</span> collision_cost = 0.0;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160; </div>
<div class="line"><a name="l00740"></a><span class="lineno"><a class="line" href="classchomp_1_1ChompOptimizer.html#a16b9649944d27ac194464763f1c381a5">  740</a></span>&#160;  <span class="keywordtype">double</span> worst_collision_cost = 0.0;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#a31c838ade46487693c228779d28c65a8">worst_collision_cost_state_</a> = -1;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160; </div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  <span class="comment">// collision costs:</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = <a class="code" href="classchomp_1_1ChompOptimizer.html#ab2028b705c347074aef529a0c4a93534">free_vars_start_</a>; i &lt;= <a class="code" href="classchomp_1_1ChompOptimizer.html#a9f4df819373a8fc4fc4c33bf3e61c3a2">free_vars_end_</a>; i++)</div>
<div class="line"><a name="l00745"></a><span class="lineno"><a class="line" href="classchomp_1_1ChompOptimizer.html#a15f03bdad314356db449de130f9be5e8">  745</a></span>&#160;  {</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <span class="keywordtype">double</span> state_collision_cost = 0.0;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classchomp_1_1ChompOptimizer.html#a5ec7779d032e89339c31556ef37f61f1">num_collision_points_</a>; j++)</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    {</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      state_collision_cost += <a class="code" href="classchomp_1_1ChompOptimizer.html#a4068aed1b38efd2f54b85b62960a7662">collision_point_potential_</a>[i][j] * <a class="code" href="classchomp_1_1ChompOptimizer.html#ac6696b62d069c117952aeca2b23de40a">collision_point_vel_mag_</a>[i][j];</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    }</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    collision_cost += state_collision_cost;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <span class="keywordflow">if</span> (state_collision_cost &gt; worst_collision_cost)</div>
<div class="line"><a name="l00753"></a><span class="lineno"><a class="line" href="classchomp_1_1ChompOptimizer.html#a5b8fb75a78691f2ccfd19fbad87027d6">  753</a></span>&#160;    {</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      worst_collision_cost = state_collision_cost;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      <a class="code" href="classchomp_1_1ChompOptimizer.html#a31c838ade46487693c228779d28c65a8">worst_collision_cost_state_</a> = i;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    }</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  }</div>
<div class="line"><a name="l00758"></a><span class="lineno"><a class="line" href="classchomp_1_1ChompOptimizer.html#a34399fd4b1c32f1a43cac03ec531f455">  758</a></span>&#160; </div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="classchomp_1_1ChompOptimizer.html#a82519d9ad09cad7a441c19136db216bf">parameters_</a>-&gt;<a class="code" href="classchomp_1_1ChompParameters.html#aeec8f058d69671792f96c7fa0017e065">obstacle_cost_weight_</a> * collision_cost;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;}</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160; </div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classchomp_1_1ChompOptimizer.html#a694f826e2e33b3a12b4054951012a152">ChompOptimizer::computeJointProperties</a>(<span class="keywordtype">int</span> trajectory_point)</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;{</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classchomp_1_1ChompOptimizer.html#ada498aefc4c6e9c5a9ee6e7b0b71fefc">num_joints_</a>; j++)</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  {</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <span class="keyword">const</span> moveit::core::JointModel* joint_model = <a class="code" href="classchomp_1_1ChompOptimizer.html#a41265fb8d09d499844098b979538d6df">state_</a>.getJointModel(<a class="code" href="classchomp_1_1ChompOptimizer.html#ae5d0efa2d46c8d3ec261cab6a010ce8f">joint_names_</a>[j]);</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <span class="keyword">const</span> moveit::core::RevoluteJointModel* revolute_joint =</div>
<div class="line"><a name="l00768"></a><span class="lineno"><a class="line" href="classchomp_1_1ChompOptimizer.html#a45ee586e9c8e970059f81cc3b595d81f">  768</a></span>&#160;        <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>moveit::core::RevoluteJointModel*<span class="keyword">&gt;</span>(joint_model);</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <span class="keyword">const</span> moveit::core::PrismaticJointModel* prismatic_joint =</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>moveit::core::PrismaticJointModel*<span class="keyword">&gt;</span>(joint_model);</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160; </div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    std::string parent_link_name = joint_model-&gt;getParentLinkModel()-&gt;getName();</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    std::string child_link_name = joint_model-&gt;getChildLinkModel()-&gt;getName();</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    Eigen::Isometry3d joint_transform = <a class="code" href="classchomp_1_1ChompOptimizer.html#a41265fb8d09d499844098b979538d6df">state_</a>.getGlobalLinkTransform(parent_link_name) *</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                                        (<a class="code" href="classchomp_1_1ChompOptimizer.html#aa77c3cd6c65392e107c6aa732a0dd867">robot_model_</a>-&gt;getLinkModel(child_link_name)-&gt;getJointOriginTransform() *</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                                         (<a class="code" href="classchomp_1_1ChompOptimizer.html#a41265fb8d09d499844098b979538d6df">state_</a>.getJointTransform(joint_model)));</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160; </div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <span class="comment">// joint_transform = inverseWorldTransform * jointTransform;</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    Eigen::Vector3d axis;</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160; </div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="keywordflow">if</span> (revolute_joint != <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    {</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      axis = revolute_joint-&gt;getAxis();</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    }</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (prismatic_joint != <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    {</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;      axis = prismatic_joint-&gt;getAxis();</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    }</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    {</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;      axis = Eigen::Vector3d::Identity();</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    }</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160; </div>
<div class="line"><a name="l00794"></a><span class="lineno"><a class="line" href="classchomp_1_1ChompOptimizer.html#a694f826e2e33b3a12b4054951012a152">  794</a></span>&#160;    axis = joint_transform * axis;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160; </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <a class="code" href="classchomp_1_1ChompOptimizer.html#acf4ca8d231b15a584ae0ce98779850bd">joint_axes_</a>[trajectory_point][j] = axis;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <a class="code" href="classchomp_1_1ChompOptimizer.html#a9af8690faea1fe76e6c953d3ad554b56">joint_positions_</a>[trajectory_point][j] = joint_transform.translation();</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  }</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;}</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160; </div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> Derived&gt;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classchomp_1_1ChompOptimizer.html#a4b4034539ad534476cadce76a3327e04">ChompOptimizer::getJacobian</a>(<span class="keywordtype">int</span> trajectory_point, Eigen::Vector3d&amp; collision_point_pos, std::string&amp; joint_name,</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                                 Eigen::MatrixBase&lt;Derived&gt;&amp; jacobian)<span class="keyword"> const</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classchomp_1_1ChompOptimizer.html#ada498aefc4c6e9c5a9ee6e7b0b71fefc">num_joints_</a>; j++)</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  {</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classchomp_1_1ChompOptimizer.html#acfaa34daef6a1ac609561fefa6dba948">isParent</a>(joint_name, <a class="code" href="classchomp_1_1ChompOptimizer.html#ae5d0efa2d46c8d3ec261cab6a010ce8f">joint_names_</a>[j]))</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    {</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;      Eigen::Vector3d column = <a class="code" href="classchomp_1_1ChompOptimizer.html#acf4ca8d231b15a584ae0ce98779850bd">joint_axes_</a>[trajectory_point][j].cross(</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;          Eigen::Vector3d(collision_point_pos(0), collision_point_pos(1), collision_point_pos(2)) -</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;          <a class="code" href="classchomp_1_1ChompOptimizer.html#a9af8690faea1fe76e6c953d3ad554b56">joint_positions_</a>[trajectory_point][j]);</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160; </div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;      jacobian.col(j)[0] = column.x();</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;      jacobian.col(j)[1] = column.y();</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;      jacobian.col(j)[2] = column.z();</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    }</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    {</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;      jacobian.col(j)[0] = 0.0;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;      jacobian.col(j)[1] = 0.0;</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;      jacobian.col(j)[2] = 0.0;</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    }</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;  }</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;}</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160; </div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classchomp_1_1ChompOptimizer.html#a836de9ad21ca36219b237be668376969">ChompOptimizer::handleJointLimits</a>()</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;{</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;  <span class="keyword">const</span> std::vector&lt;const moveit::core::JointModel*&gt; joint_models = <a class="code" href="classchomp_1_1ChompOptimizer.html#ac449fe23198404a23ccc12d45ad0a0cb">joint_model_group_</a>-&gt;getActiveJointModels();</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> joint_i = 0; joint_i &lt; joint_models.size(); joint_i++)</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;  {</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="keyword">const</span> moveit::core::JointModel* joint_model = joint_models[joint_i];</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160; </div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <span class="keywordflow">if</span> (joint_model-&gt;getType() == moveit::core::JointModel::REVOLUTE)</div>
<div class="line"><a name="l00834"></a><span class="lineno"><a class="line" href="classchomp_1_1ChompOptimizer.html#a4b4034539ad534476cadce76a3327e04">  834</a></span>&#160;    {</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;      <span class="keyword">const</span> moveit::core::RevoluteJointModel* revolute_joint =</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;          <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span>moveit::core::RevoluteJointModel*<span class="keyword">&gt;</span>(joint_model);</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;      <span class="keywordflow">if</span> (revolute_joint-&gt;isContinuous())</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;      {</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;        <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;      }</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    }</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160; </div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;    <span class="keyword">const</span> moveit::core::JointModel::Bounds&amp; bounds = joint_model-&gt;getVariableBounds();</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160; </div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <span class="keywordtype">double</span> joint_max = -DBL_MAX;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;    <span class="keywordtype">double</span> joint_min = DBL_MAX;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160; </div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">const</span> moveit::core::VariableBounds&amp; bound : bounds)</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    {</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;      <span class="keywordflow">if</span> (bound.min_position_ &lt; joint_min)</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;      {</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        joint_min = bound.min_position_;</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;      }</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160; </div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;      <span class="keywordflow">if</span> (bound.max_position_ &gt; joint_max)</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      {</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        joint_max = bound.max_position_;</div>
<div class="line"><a name="l00858"></a><span class="lineno"><a class="line" href="classchomp_1_1ChompOptimizer.html#a836de9ad21ca36219b237be668376969">  858</a></span>&#160;      }</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    }</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160; </div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <span class="keywordtype">int</span> count = 0;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160; </div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <span class="keywordtype">bool</span> violation = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <span class="keywordflow">do</span></div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    {</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;      <span class="keywordtype">double</span> max_abs_violation = 1e-6;</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;      <span class="keywordtype">double</span> max_violation = 0.0;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;      <span class="keywordtype">int</span> max_violation_index = 0;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;      violation = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = <a class="code" href="classchomp_1_1ChompOptimizer.html#ab2028b705c347074aef529a0c4a93534">free_vars_start_</a>; i &lt;= <a class="code" href="classchomp_1_1ChompOptimizer.html#a9f4df819373a8fc4fc4c33bf3e61c3a2">free_vars_end_</a>; i++)</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      {</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        <span class="keywordtype">double</span> amount = 0.0;</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        <span class="keywordtype">double</span> absolute_amount = 0.0;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classchomp_1_1ChompOptimizer.html#ac8a33d22edb4dac95d88480f0b114ba1">group_trajectory_</a>(i, joint_i) &gt; joint_max)</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        {</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;          amount = joint_max - <a class="code" href="classchomp_1_1ChompOptimizer.html#ac8a33d22edb4dac95d88480f0b114ba1">group_trajectory_</a>(i, joint_i);</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;          absolute_amount = fabs(amount);</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;        }</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classchomp_1_1ChompOptimizer.html#ac8a33d22edb4dac95d88480f0b114ba1">group_trajectory_</a>(i, joint_i) &lt; joint_min)</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        {</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;          amount = joint_min - <a class="code" href="classchomp_1_1ChompOptimizer.html#ac8a33d22edb4dac95d88480f0b114ba1">group_trajectory_</a>(i, joint_i);</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;          absolute_amount = fabs(amount);</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        }</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        <span class="keywordflow">if</span> (absolute_amount &gt; max_abs_violation)</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        {</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;          max_abs_violation = absolute_amount;</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;          max_violation = amount;</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;          max_violation_index = i;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;          violation = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        }</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;      }</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160; </div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;      <span class="keywordflow">if</span> (violation)</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      {</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        <span class="keywordtype">int</span> free_var_index = max_violation_index - <a class="code" href="classchomp_1_1ChompOptimizer.html#ab2028b705c347074aef529a0c4a93534">free_vars_start_</a>;</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        <span class="keywordtype">double</span> multiplier =</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;            max_violation / <a class="code" href="classchomp_1_1ChompOptimizer.html#ad522962453ef1b68c88b0d177e49add6">joint_costs_</a>[joint_i].getQuadraticCostInverse()(free_var_index, free_var_index);</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        <a class="code" href="classchomp_1_1ChompOptimizer.html#ac8a33d22edb4dac95d88480f0b114ba1">group_trajectory_</a>.<a class="code" href="classchomp_1_1ChompTrajectory.html#a836c2da7e22cfee2acaf0b230feb6c1f">getFreeJointTrajectoryBlock</a>(joint_i) +=</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;            multiplier * <a class="code" href="classchomp_1_1ChompOptimizer.html#ad522962453ef1b68c88b0d177e49add6">joint_costs_</a>[joint_i].getQuadraticCostInverse().col(free_var_index);</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;      }</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;      <span class="keywordflow">if</span> (++count &gt; 10)</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    } <span class="keywordflow">while</span> (violation);</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;  }</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;}</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160; </div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classchomp_1_1ChompOptimizer.html#a1e7ec0f06f19405956b5dab1e63f2c74">ChompOptimizer::performForwardKinematics</a>()</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;{</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  <span class="keywordtype">double</span> inv_time = 1.0 / <a class="code" href="classchomp_1_1ChompOptimizer.html#ac8a33d22edb4dac95d88480f0b114ba1">group_trajectory_</a>.<a class="code" href="classchomp_1_1ChompTrajectory.html#a555a33aaa519180084a11cf60575e851">getDiscretization</a>();</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  <span class="keywordtype">double</span> inv_time_sq = inv_time * inv_time;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160; </div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;  <span class="comment">// calculate the forward kinematics for the fixed states only in the first iteration:</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;  <span class="keywordtype">int</span> start = <a class="code" href="classchomp_1_1ChompOptimizer.html#ab2028b705c347074aef529a0c4a93534">free_vars_start_</a>;</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  <span class="keywordtype">int</span> end = <a class="code" href="classchomp_1_1ChompOptimizer.html#a9f4df819373a8fc4fc4c33bf3e61c3a2">free_vars_end_</a>;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classchomp_1_1ChompOptimizer.html#aee94008b982c7fd677c6c2191e5bfd75">iteration_</a> == 0)</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;  {</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    start = 0;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    end = <a class="code" href="classchomp_1_1ChompOptimizer.html#a10178cbef38ab61ec8efe6ff1f537b37">num_vars_all_</a> - 1;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;  }</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160; </div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#ac115aaab6bcdf4ffc4bb3abbb7cc3320">is_collision_free_</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160; </div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;  ros::WallDuration total_dur(0.0);</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160; </div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  <span class="comment">// for each point in the trajectory</span></div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = start; i &lt;= end; ++i)</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  {</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <span class="comment">// Set Robot state from trajectory point...</span></div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;    collision_detection::CollisionRequest req;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    collision_detection::CollisionResult res;</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    req.group_name = <a class="code" href="classchomp_1_1ChompOptimizer.html#a0bf78e07c502c4a51d2f87ea4762e622">planning_group_</a>;</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <a class="code" href="classchomp_1_1ChompOptimizer.html#a9dd8e8d8f903112d32743448090a0cbd">setRobotStateFromPoint</a>(<a class="code" href="classchomp_1_1ChompOptimizer.html#ac8a33d22edb4dac95d88480f0b114ba1">group_trajectory_</a>, i);</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    ros::WallTime grad = ros::WallTime::now();</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160; </div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <a class="code" href="classchomp_1_1ChompOptimizer.html#a40a132a004cb8f02a496f552bdcefeb5">hy_env_</a>-&gt;getCollisionGradients(req, res, <a class="code" href="classchomp_1_1ChompOptimizer.html#a41265fb8d09d499844098b979538d6df">state_</a>, <span class="keyword">nullptr</span>, <a class="code" href="classchomp_1_1ChompOptimizer.html#afbb9263fa4e62b19d6e8128cd57c477b">gsr_</a>);</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    total_dur += (ros::WallTime::now() - grad);</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <a class="code" href="classchomp_1_1ChompOptimizer.html#a694f826e2e33b3a12b4054951012a152">computeJointProperties</a>(i);</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    <a class="code" href="classchomp_1_1ChompOptimizer.html#a7eb2fa24e9cf2b0157b20d348a8cef86">state_is_in_collision_</a>[i] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00939"></a><span class="lineno"><a class="line" href="classchomp_1_1ChompOptimizer.html#a1e7ec0f06f19405956b5dab1e63f2c74">  939</a></span>&#160; </div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <span class="comment">// Keep vars in scope</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    {</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;      <span class="keywordtype">size_t</span> j = 0;</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> collision_detection::GradientInfo&amp; info : <a class="code" href="classchomp_1_1ChompOptimizer.html#afbb9263fa4e62b19d6e8128cd57c477b">gsr_</a>-&gt;gradients_)</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;      {</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> k = 0; k &lt; info.sphere_locations.size(); k++)</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;        {</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;          <a class="code" href="classchomp_1_1ChompOptimizer.html#abe45133eaaa4dfbc2224abaa25a5f7e1">collision_point_pos_eigen_</a>[i][j][0] = info.sphere_locations[k].x();</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;          <a class="code" href="classchomp_1_1ChompOptimizer.html#abe45133eaaa4dfbc2224abaa25a5f7e1">collision_point_pos_eigen_</a>[i][j][1] = info.sphere_locations[k].y();</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;          <a class="code" href="classchomp_1_1ChompOptimizer.html#abe45133eaaa4dfbc2224abaa25a5f7e1">collision_point_pos_eigen_</a>[i][j][2] = info.sphere_locations[k].z();</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160; </div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;          <a class="code" href="classchomp_1_1ChompOptimizer.html#a4068aed1b38efd2f54b85b62960a7662">collision_point_potential_</a>[i][j] =</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;              <a class="code" href="classchomp_1_1ChompOptimizer.html#a13b08a670ac183c2a6f8e3dcf1dd27ff">getPotential</a>(info.distances[k], info.sphere_radii[k], <a class="code" href="classchomp_1_1ChompOptimizer.html#a82519d9ad09cad7a441c19136db216bf">parameters_</a>-&gt;<a class="code" href="classchomp_1_1ChompParameters.html#a7b0cd3dafbbde6d1d3afd1025a3a3e0d">min_clearance_</a>);</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;          <a class="code" href="classchomp_1_1ChompOptimizer.html#a5f7219b0c2f2eece57910cb22d9c7ef1">collision_point_potential_gradient_</a>[i][j][0] = info.gradients[k].x();</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;          <a class="code" href="classchomp_1_1ChompOptimizer.html#a5f7219b0c2f2eece57910cb22d9c7ef1">collision_point_potential_gradient_</a>[i][j][1] = info.gradients[k].y();</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;          <a class="code" href="classchomp_1_1ChompOptimizer.html#a5f7219b0c2f2eece57910cb22d9c7ef1">collision_point_potential_gradient_</a>[i][j][2] = info.gradients[k].z();</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160; </div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;          <a class="code" href="classchomp_1_1ChompOptimizer.html#afc9b1c126a4051a508d59a021b0315c2">point_is_in_collision_</a>[i][j] = (info.distances[k] - info.sphere_radii[k] &lt; info.sphere_radii[k]);</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160; </div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="classchomp_1_1ChompOptimizer.html#afc9b1c126a4051a508d59a021b0315c2">point_is_in_collision_</a>[i][j])</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;          {</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;            <a class="code" href="classchomp_1_1ChompOptimizer.html#a7eb2fa24e9cf2b0157b20d348a8cef86">state_is_in_collision_</a>[i] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;            <span class="comment">// if(is_collision_free_ == true) {</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;            <span class="comment">//   ROS_INFO_STREAM(&quot;We know it&#39;s not collision free &quot; &lt;&lt; g);</span></div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;            <span class="comment">//   ROS_INFO_STREAM(&quot;Sphere location &quot; &lt;&lt; info.sphere_locations[k].x() &lt;&lt; &quot; &quot; &lt;&lt;</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;            <span class="comment">//   info.sphere_locations[k].y() &lt;&lt; &quot; &quot; &lt;&lt; info.sphere_locations[k].z());</span></div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;            <span class="comment">//   ROS_INFO_STREAM(&quot;Gradient &quot; &lt;&lt; info.gradients[k].x() &lt;&lt; &quot; &quot; &lt;&lt; info.gradients[k].y() &lt;&lt; &quot; &quot; &lt;&lt;</span></div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;            <span class="comment">//   info.gradients[k].z() &lt;&lt; &quot; distance &quot; &lt;&lt; info.distances[k] &lt;&lt; &quot; radii &quot; &lt;&lt; info.sphere_radii[k]);</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;            <span class="comment">//   ROS_INFO_STREAM(&quot;Radius &quot; &lt;&lt; info.sphere_radii[k] &lt;&lt; &quot; potential &quot; &lt;&lt;</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;            <span class="comment">//   collision_point_potential_[i][j]);</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;            <span class="comment">// }</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160; </div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;            <a class="code" href="classchomp_1_1ChompOptimizer.html#ac115aaab6bcdf4ffc4bb3abbb7cc3320">is_collision_free_</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;          }</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;          j++;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        }</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;      }</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    }</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;  }</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160; </div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;  <span class="comment">// ROS_INFO_STREAM(&quot;Total dur &quot; &lt;&lt; total_dur &lt;&lt; &quot; total checks &quot; &lt;&lt; end-start+1);</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160; </div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;  <span class="comment">// now, get the vel and acc for each collision point (using finite differencing)</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = <a class="code" href="classchomp_1_1ChompOptimizer.html#ab2028b705c347074aef529a0c4a93534">free_vars_start_</a>; i &lt;= <a class="code" href="classchomp_1_1ChompOptimizer.html#a9f4df819373a8fc4fc4c33bf3e61c3a2">free_vars_end_</a>; i++)</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;  {</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classchomp_1_1ChompOptimizer.html#a5ec7779d032e89339c31556ef37f61f1">num_collision_points_</a>; j++)</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    {</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;      <a class="code" href="classchomp_1_1ChompOptimizer.html#a18cc68cc4fd817ebf5f5e51297a8e7e8">collision_point_vel_eigen_</a>[i][j] = Eigen::Vector3d(0, 0, 0);</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;      <a class="code" href="classchomp_1_1ChompOptimizer.html#a8c1ece38b849b164289f5753945f3c95">collision_point_acc_eigen_</a>[i][j] = Eigen::Vector3d(0, 0, 0);</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = -<a class="code" href="namespacechomp.html#a00ceb4fc5e1c66b78ed4f27ec5070890">DIFF_RULE_LENGTH</a> / 2; k &lt;= <a class="code" href="namespacechomp.html#a00ceb4fc5e1c66b78ed4f27ec5070890">DIFF_RULE_LENGTH</a> / 2; k++)</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;      {</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;        <a class="code" href="classchomp_1_1ChompOptimizer.html#a18cc68cc4fd817ebf5f5e51297a8e7e8">collision_point_vel_eigen_</a>[i][j] +=</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;            (inv_time * <a class="code" href="namespacechomp.html#ab286a447a07d0fe5e8dc07aa5009ab52">DIFF_RULES</a>[0][k + <a class="code" href="namespacechomp.html#a00ceb4fc5e1c66b78ed4f27ec5070890">DIFF_RULE_LENGTH</a> / 2]) * <a class="code" href="classchomp_1_1ChompOptimizer.html#abe45133eaaa4dfbc2224abaa25a5f7e1">collision_point_pos_eigen_</a>[i + k][j];</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;        <a class="code" href="classchomp_1_1ChompOptimizer.html#a8c1ece38b849b164289f5753945f3c95">collision_point_acc_eigen_</a>[i][j] +=</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;            (inv_time_sq * <a class="code" href="namespacechomp.html#ab286a447a07d0fe5e8dc07aa5009ab52">DIFF_RULES</a>[1][k + <a class="code" href="namespacechomp.html#a00ceb4fc5e1c66b78ed4f27ec5070890">DIFF_RULE_LENGTH</a> / 2]) * <a class="code" href="classchomp_1_1ChompOptimizer.html#abe45133eaaa4dfbc2224abaa25a5f7e1">collision_point_pos_eigen_</a>[i + k][j];</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;      }</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160; </div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;      <span class="comment">// get the norm of the velocity:</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;      <a class="code" href="classchomp_1_1ChompOptimizer.html#ac6696b62d069c117952aeca2b23de40a">collision_point_vel_mag_</a>[i][j] = <a class="code" href="classchomp_1_1ChompOptimizer.html#a18cc68cc4fd817ebf5f5e51297a8e7e8">collision_point_vel_eigen_</a>[i][j].norm();</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    }</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;  }</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;}</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160; </div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classchomp_1_1ChompOptimizer.html#a9dd8e8d8f903112d32743448090a0cbd">ChompOptimizer::setRobotStateFromPoint</a>(ChompTrajectory&amp; group_trajectory, <span class="keywordtype">int</span> i)</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;{</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;  <span class="keyword">const</span> Eigen::MatrixXd::RowXpr&amp; point = group_trajectory.getTrajectoryPoint(i);</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160; </div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;  std::vector&lt;double&gt; joint_states;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;  joint_states.reserve(group_trajectory.getNumJoints());</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> j = 0; j &lt; group_trajectory.getNumJoints(); j++)</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    joint_states.emplace_back(point(0, j));</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160; </div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#a41265fb8d09d499844098b979538d6df">state_</a>.setJointGroupPositions(<a class="code" href="classchomp_1_1ChompOptimizer.html#a0bf78e07c502c4a51d2f87ea4762e622">planning_group_</a>, joint_states);</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#a41265fb8d09d499844098b979538d6df">state_</a>.update();</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;}</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160; </div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classchomp_1_1ChompOptimizer.html#a9d660cc8157a54e74a16608602ae2d4d">ChompOptimizer::perturbTrajectory</a>()</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;{</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;  <span class="comment">// int mid_point = (free_vars_start_ + free_vars_end_) / 2;</span></div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classchomp_1_1ChompOptimizer.html#a31c838ade46487693c228779d28c65a8">worst_collision_cost_state_</a> &lt; 0)</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;  <span class="keywordtype">int</span> mid_point = <a class="code" href="classchomp_1_1ChompOptimizer.html#a31c838ade46487693c228779d28c65a8">worst_collision_cost_state_</a>;</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  moveit::core::RobotState random_state = <a class="code" href="classchomp_1_1ChompOptimizer.html#a41265fb8d09d499844098b979538d6df">state_</a>;</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;  <span class="keyword">const</span> moveit::core::JointModelGroup* planning_group = <a class="code" href="classchomp_1_1ChompOptimizer.html#a41265fb8d09d499844098b979538d6df">state_</a>.getJointModelGroup(<a class="code" href="classchomp_1_1ChompOptimizer.html#a0bf78e07c502c4a51d2f87ea4762e622">planning_group_</a>);</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;  random_state.setToRandomPositions(planning_group);</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  std::vector&lt;double&gt; vals;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  random_state.copyJointGroupPositions(<a class="code" href="classchomp_1_1ChompOptimizer.html#a0bf78e07c502c4a51d2f87ea4762e622">planning_group_</a>, vals);</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  <span class="keywordtype">double</span>* ptr = &amp;vals[0];</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  Eigen::Map&lt;Eigen::VectorXd&gt; random_matrix(ptr, vals.size());</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;  <span class="comment">// Eigen::VectorXd random_matrix = vals;</span></div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160; </div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;  <span class="comment">// convert the state into an increment</span></div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  random_matrix -= <a class="code" href="classchomp_1_1ChompOptimizer.html#ac8a33d22edb4dac95d88480f0b114ba1">group_trajectory_</a>.<a class="code" href="classchomp_1_1ChompTrajectory.html#a98259b5fe962c1f2e010b3bb747324f3">getTrajectoryPoint</a>(mid_point).transpose();</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160; </div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;  <span class="comment">// project the increment orthogonal to joint velocities</span></div>
<div class="line"><a name="l01035"></a><span class="lineno"><a class="line" href="classchomp_1_1ChompOptimizer.html#a9dd8e8d8f903112d32743448090a0cbd"> 1035</a></span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#ac8a33d22edb4dac95d88480f0b114ba1">group_trajectory_</a>.<a class="code" href="classchomp_1_1ChompTrajectory.html#a848e22be4db55637dc2eb1141111c0c1">getJointVelocities</a>(mid_point, <a class="code" href="classchomp_1_1ChompOptimizer.html#a88db4a4ea2dd1f55b819d21aab70785f">joint_state_velocities_</a>);</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;  <a class="code" href="classchomp_1_1ChompOptimizer.html#a88db4a4ea2dd1f55b819d21aab70785f">joint_state_velocities_</a>.normalize();</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;  random_matrix = (Eigen::MatrixXd::Identity(<a class="code" href="classchomp_1_1ChompOptimizer.html#ada498aefc4c6e9c5a9ee6e7b0b71fefc">num_joints_</a>, <a class="code" href="classchomp_1_1ChompOptimizer.html#ada498aefc4c6e9c5a9ee6e7b0b71fefc">num_joints_</a>) -</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;                   <a class="code" href="classchomp_1_1ChompOptimizer.html#a88db4a4ea2dd1f55b819d21aab70785f">joint_state_velocities_</a> * <a class="code" href="classchomp_1_1ChompOptimizer.html#a88db4a4ea2dd1f55b819d21aab70785f">joint_state_velocities_</a>.transpose()) *</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                  random_matrix;</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160; </div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;  <span class="keywordtype">int</span> mp_free_vars_index = mid_point - <a class="code" href="classchomp_1_1ChompOptimizer.html#ab2028b705c347074aef529a0c4a93534">free_vars_start_</a>;</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classchomp_1_1ChompOptimizer.html#ada498aefc4c6e9c5a9ee6e7b0b71fefc">num_joints_</a>; i++)</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;  {</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    <a class="code" href="classchomp_1_1ChompOptimizer.html#ac8a33d22edb4dac95d88480f0b114ba1">group_trajectory_</a>.<a class="code" href="classchomp_1_1ChompTrajectory.html#a836c2da7e22cfee2acaf0b230feb6c1f">getFreeJointTrajectoryBlock</a>(i) +=</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;        <a class="code" href="classchomp_1_1ChompOptimizer.html#ad522962453ef1b68c88b0d177e49add6">joint_costs_</a>[i].getQuadraticCostInverse().col(mp_free_vars_index) * <a class="code" href="classchomp_1_1ChompOptimizer.html#a1460cddc9f6d8fb5b819100f77126179">random_state_</a>(i);</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;  }</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;}</div>
<div class="line"><a name="l01048"></a><span class="lineno"><a class="line" href="classchomp_1_1ChompOptimizer.html#a9d660cc8157a54e74a16608602ae2d4d"> 1048</a></span>&#160; </div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<span class="comment">// void ChompOptimizer::getRandomState(const RobotState currentState, const string&amp; groupName, Eigen::VectorXd&amp;</span></div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="comment">// state_vec)</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="comment">// {</span></div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="comment">//   const vector&lt;RobotState *::JointState*&gt;&amp; jointStates =</span></div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="comment">//     currentState-&gt;getJointStateGroup(groupName)-&gt;getJointStateVector();</span></div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="comment">//   for(size_t i = 0; i &lt; jointStates.size(); i++)</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="comment">//   {</span></div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160; </div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="comment">//     bool continuous = false;</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160; </div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="comment">//     RobotState *::JointState* jointState = jointStates[i];</span></div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;<span class="comment">//     const RevoluteJointModel* revolute_joint</span></div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="comment">//       = dynamic_cast&lt;const RevoluteJointModel*&gt;(jointState-&gt;getJointModel());</span></div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;<span class="comment">//     if(revolute_joint &amp;&amp; revolute_joint-&gt;continuous_) {</span></div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="comment">//       continuous = true;</span></div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="comment">//     }</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160; </div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;<span class="comment">//     map&lt;string, pair&lt;double, double&gt; &gt; bounds = jointState-&gt;getJointModel()-&gt;getAllVariableBounds();</span></div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;<span class="comment">//     int j = 0;</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;<span class="comment">//     for(map&lt;string, pair&lt;double, double&gt; &gt;::iterator it = bounds.begin(); it != bounds.end(); it++)</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;<span class="comment">//     {</span></div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;<span class="comment">//       double randVal = jointState-&gt;getJointStateValues()[j] + (getRandomDouble()</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;<span class="comment">//                                                                * (parameters_-&gt;getRandomJumpAmount()) -</span></div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;<span class="comment">//                                                                getRandomDouble() *</span></div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;<span class="comment">//                                                                (parameters_-&gt;getRandomJumpAmount()));</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160; </div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="comment">//       if(!continuous)</span></div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="comment">//       {</span></div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="comment">//         if(randVal &gt; it-&gt;second.second)</span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="comment">//         {</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;<span class="comment">//           randVal = it-&gt;second.second;</span></div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="comment">//         }</span></div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="comment">//         else if(randVal &lt; it-&gt;second.first)</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="comment">//         {</span></div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;<span class="comment">//           randVal = it-&gt;second.first;</span></div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;<span class="comment">//         }</span></div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;<span class="comment">//       }</span></div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160; </div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="comment">//       ROS_DEBUG_STREAM(&quot;Joint &quot; &lt;&lt; it-&gt;first &lt;&lt; &quot; old value &quot; &lt;&lt; jointState-&gt;getJointStateValues()[j] &lt;&lt; &quot; new value</span></div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="comment">//       &quot; &lt;&lt; randVal);</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;<span class="comment">//       state_vec(i) = randVal;</span></div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160; </div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<span class="comment">//       j++;</span></div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="comment">//     }</span></div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="comment">//   }</span></div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="comment">// }</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160; </div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="comment">/*</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="comment">void ChompOptimizer::getRandomMomentum()</span></div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="comment">{</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;<span class="comment">  if (is_collision_free_)</span></div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;<span class="comment">    random_momentum_.setZero(num_vars_free_, num_joints_);</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;<span class="comment">  else</span></div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="comment">    for (int i = 0; i &lt; num_joints_; ++i)</span></div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;<span class="comment">    {</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;<span class="comment">      multivariate_gaussian_[i].sample(random_joint_momentum_);</span></div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;<span class="comment">      random_momentum_.col(i) = stochasticity_factor_ * random_joint_momentum_;</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="comment">}</span></div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="comment">void ChompOptimizer::updateMomentum()</span></div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="comment">{</span></div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="comment">  // double alpha = 1.0 - parameters_-&gt;getHmcStochasticity();</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;<span class="comment">  double eps = parameters_-&gt;getHmcDiscretization();</span></div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;<span class="comment">  if (iteration_ &gt; 0)</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;<span class="comment">    momentum_ = (momentum_ + eps * final_increments_);</span></div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;<span class="comment">  else</span></div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;<span class="comment">    momentum_ = random_momentum_;</span></div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;<span class="comment">  // momentum_ = alpha * (momentum_ + eps*final_increments_) + sqrt(1.0-alpha*alpha)*random_momentum_;</span></div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="comment">}</span></div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="comment">void ChompOptimizer::updatePositionFromMomentum()</span></div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;<span class="comment">{</span></div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;<span class="comment">  double eps = parameters_-&gt;getHmcDiscretization();</span></div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;<span class="comment">  group_trajectory_.getFreeTrajectoryBlock() += eps * momentum_;</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;<span class="comment">}</span></div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160; </div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;}  <span class="comment">// namespace chomp</span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclasschomp_1_1ChompParameters_html_ad429eeecfa51f163373e5f89a8593d11"><div class="ttname"><a href="classchomp_1_1ChompParameters.html#ad429eeecfa51f163373e5f89a8593d11">chomp::ChompParameters::max_iterations_after_collision_free_</a></div><div class="ttdeci">int max_iterations_after_collision_free_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__parameters_8h_source.html#l00133">chomp_parameters.h:133</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_ae07453fd4e982a96406e68ffd7058f2b"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#ae07453fd4e982a96406e68ffd7058f2b">chomp::ChompOptimizer::initialize</a></div><div class="ttdeci">void initialize()</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8cpp_source.html#l00124">chomp_optimizer.cpp:124</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompParameters_html_a057028f02f3a2314a57351221b17b8c6"><div class="ttname"><a href="classchomp_1_1ChompParameters.html#a057028f02f3a2314a57351221b17b8c6">chomp::ChompParameters::planning_time_limit_</a></div><div class="ttdeci">double planning_time_limit_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__parameters_8h_source.html#l00130">chomp_parameters.h:130</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a4d092cc008b0cf9bd47971fee55f30ca"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a4d092cc008b0cf9bd47971fee55f30ca">chomp::ChompOptimizer::num_collision_free_iterations_</a></div><div class="ttdeci">unsigned int num_collision_free_iterations_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00216">chomp_optimizer.h:216</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a1460cddc9f6d8fb5b819100f77126179"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a1460cddc9f6d8fb5b819100f77126179">chomp::ChompOptimizer::random_state_</a></div><div class="ttdeci">Eigen::VectorXd random_state_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00240">chomp_optimizer.h:240</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a9e5a7b8bd8a882869725e42e92237ba7"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a9e5a7b8bd8a882869725e42e92237ba7">chomp::ChompOptimizer::jacobian_pseudo_inverse_</a></div><div class="ttdeci">Eigen::MatrixXd jacobian_pseudo_inverse_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00238">chomp_optimizer.h:238</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a0bf78e07c502c4a51d2f87ea4762e622"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a0bf78e07c502c4a51d2f87ea4762e622">chomp::ChompOptimizer::planning_group_</a></div><div class="ttdeci">std::string planning_group_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00190">chomp_optimizer.h:190</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a4b4034539ad534476cadce76a3327e04"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a4b4034539ad534476cadce76a3327e04">chomp::ChompOptimizer::getJacobian</a></div><div class="ttdeci">void getJacobian(int trajectoryPoint, Eigen::Vector3d &amp;collision_point_pos, std::string &amp;jointName, Eigen::MatrixBase&lt; Derived &gt; &amp;jacobian) const</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8cpp_source.html#l00834">chomp_optimizer.cpp:834</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a82519d9ad09cad7a441c19136db216bf"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a82519d9ad09cad7a441c19136db216bf">chomp::ChompOptimizer::parameters_</a></div><div class="ttdeci">const ChompParameters * parameters_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00191">chomp_optimizer.h:191</a></div></div>
<div class="ttc" id="anamespacechomp_html_ab286a447a07d0fe5e8dc07aa5009ab52"><div class="ttname"><a href="namespacechomp.html#ab286a447a07d0fe5e8dc07aa5009ab52">chomp::DIFF_RULES</a></div><div class="ttdeci">static const double DIFF_RULES[3][DIFF_RULE_LENGTH]</div><div class="ttdef"><b>Definition:</b> <a href="chomp__utils_8h_source.html#l00080">chomp_utils.h:80</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a2db6515a66d055215071b41514c4936e"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a2db6515a66d055215071b41514c4936e">chomp::ChompOptimizer::addIncrementsToTrajectory</a></div><div class="ttdeci">void addIncrementsToTrajectory()</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8cpp_source.html#l00720">chomp_optimizer.cpp:720</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_ae68d937e3dc3a104132bebf9ad65cf92"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#ae68d937e3dc3a104132bebf9ad65cf92">chomp::ChompOptimizer::multivariate_gaussian_</a></div><div class="ttdeci">std::vector&lt; MultivariateGaussian &gt; multivariate_gaussian_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00222">chomp_optimizer.h:222</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompTrajectory_html_a4492f077e039ff75bf4a62f678242898"><div class="ttname"><a href="classchomp_1_1ChompTrajectory.html#a4492f077e039ff75bf4a62f678242898">chomp::ChompTrajectory::updateFromGroupTrajectory</a></div><div class="ttdeci">void updateFromGroupTrajectory(const ChompTrajectory &amp;group_trajectory)</div><div class="ttdoc">Updates the full trajectory (*this) from the group trajectory.</div><div class="ttdef"><b>Definition:</b> <a href="chomp__trajectory_8cpp_source.html#l00132">chomp_trajectory.cpp:132</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a9dd8e8d8f903112d32743448090a0cbd"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a9dd8e8d8f903112d32743448090a0cbd">chomp::ChompOptimizer::setRobotStateFromPoint</a></div><div class="ttdeci">void setRobotStateFromPoint(ChompTrajectory &amp;group_trajectory, int i)</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8cpp_source.html#l01035">chomp_optimizer.cpp:1035</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a7b74f22b7289e6c124db5aa0088731b9"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a7b74f22b7289e6c124db5aa0088731b9">chomp::ChompOptimizer::collision_free_iteration_</a></div><div class="ttdeci">unsigned int collision_free_iteration_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00186">chomp_optimizer.h:186</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_afbb9263fa4e62b19d6e8128cd57c477b"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#afbb9263fa4e62b19d6e8128cd57c477b">chomp::ChompOptimizer::gsr_</a></div><div class="ttdeci">collision_detection::GroupStateRepresentationPtr gsr_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00200">chomp_optimizer.h:200</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a70c367db1a30edc1cb3c97c4328749d2"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a70c367db1a30edc1cb3c97c4328749d2">chomp::ChompOptimizer::collision_point_joint_names_</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; std::string &gt; &gt; collision_point_joint_names_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00203">chomp_optimizer.h:203</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_ac449fe23198404a23ccc12d45ad0a0cb"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#ac449fe23198404a23ccc12d45ad0a0cb">chomp::ChompOptimizer::joint_model_group_</a></div><div class="ttdeci">const moveit::core::JointModelGroup * joint_model_group_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00196">chomp_optimizer.h:196</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a8c1ece38b849b164289f5753945f3c95"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a8c1ece38b849b164289f5753945f3c95">chomp::ChompOptimizer::collision_point_acc_eigen_</a></div><div class="ttdeci">std::vector&lt; EigenSTL::vector_Vector3d &gt; collision_point_acc_eigen_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00206">chomp_optimizer.h:206</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompParameters_html_ad3636d8c33aa7e70e482749ff58fe7cc"><div class="ttname"><a href="classchomp_1_1ChompParameters.html#ad3636d8c33aa7e70e482749ff58fe7cc">chomp::ChompParameters::smoothness_cost_velocity_</a></div><div class="ttdeci">double smoothness_cost_velocity_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__parameters_8h_source.html#l00142">chomp_parameters.h:142</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompTrajectory_html_ae0dc82cbaec33cbe55805e66264f7fc8"><div class="ttname"><a href="classchomp_1_1ChompTrajectory.html#ae0dc82cbaec33cbe55805e66264f7fc8">chomp::ChompTrajectory::getTrajectory</a></div><div class="ttdeci">Eigen::MatrixXd &amp; getTrajectory()</div><div class="ttdoc">Gets the entire trajectory matrix.</div><div class="ttdef"><b>Definition:</b> <a href="chomp__trajectory_8h_source.html#l00304">chomp_trajectory.h:304</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a52c1ffa2020514e1da0dc51cfc607c02"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a52c1ffa2020514e1da0dc51cfc607c02">chomp::ChompOptimizer::best_group_trajectory_</a></div><div class="ttdeci">Eigen::MatrixXd best_group_trajectory_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00213">chomp_optimizer.h:213</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a95e16eaf024162f644072f3f986b9e9b"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a95e16eaf024162f644072f3f986b9e9b">chomp::ChompOptimizer::destroy</a></div><div class="ttdeci">void destroy()</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00132">chomp_optimizer.h:132</a></div></div>
<div class="ttc" id="achomp__utils_8h_html"><div class="ttname"><a href="chomp__utils_8h.html">chomp_utils.h</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a5f7219b0c2f2eece57910cb22d9c7ef1"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a5f7219b0c2f2eece57910cb22d9c7ef1">chomp::ChompOptimizer::collision_point_potential_gradient_</a></div><div class="ttdeci">std::vector&lt; EigenSTL::vector_Vector3d &gt; collision_point_potential_gradient_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00209">chomp_optimizer.h:209</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompTrajectory_html_a98259b5fe962c1f2e010b3bb747324f3"><div class="ttname"><a href="classchomp_1_1ChompTrajectory.html#a98259b5fe962c1f2e010b3bb747324f3">chomp::ChompTrajectory::getTrajectoryPoint</a></div><div class="ttdeci">Eigen::MatrixXd::RowXpr getTrajectoryPoint(int traj_point)</div><div class="ttdef"><b>Definition:</b> <a href="chomp__trajectory_8h_source.html#l00258">chomp_trajectory.h:258</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a5ec7779d032e89339c31556ef37f61f1"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a5ec7779d032e89339c31556ef37f61f1">chomp::ChompOptimizer::num_collision_points_</a></div><div class="ttdeci">int num_collision_points_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00182">chomp_optimizer.h:182</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a41dcf0f0ada22bc19c4aee890f5cc751"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a41dcf0f0ada22bc19c4aee890f5cc751">chomp::ChompOptimizer::isCurrentTrajectoryMeshToMeshCollisionFree</a></div><div class="ttdeci">bool isCurrentTrajectoryMeshToMeshCollisionFree() const</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8cpp_source.html#l00563">chomp_optimizer.cpp:563</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompTrajectory_html_a555a33aaa519180084a11cf60575e851"><div class="ttname"><a href="classchomp_1_1ChompTrajectory.html#a555a33aaa519180084a11cf60575e851">chomp::ChompTrajectory::getDiscretization</a></div><div class="ttdeci">double getDiscretization() const</div><div class="ttdoc">Gets the discretization time interval of the trajectory.</div><div class="ttdef"><b>Definition:</b> <a href="chomp__trajectory_8h_source.html#l00283">chomp_trajectory.h:283</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a0ac29189993f328f89f8fcec04d640ea"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a0ac29189993f328f89f8fcec04d640ea">chomp::ChompOptimizer::smoothness_increments_</a></div><div class="ttdeci">Eigen::MatrixXd smoothness_increments_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00231">chomp_optimizer.h:231</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a13b08a670ac183c2a6f8e3dcf1dd27ff"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a13b08a670ac183c2a6f8e3dcf1dd27ff">chomp::ChompOptimizer::getPotential</a></div><div class="ttdeci">double getPotential(double field_distance, double radius, double clearance)</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00148">chomp_optimizer.h:148</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a9e29afcf3f2c7a6e4eebe6c5f9d5f82f"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a9e29afcf3f2c7a6e4eebe6c5f9d5f82f">chomp::ChompOptimizer::calculateSmoothnessIncrements</a></div><div class="ttdeci">void calculateSmoothnessIncrements()</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8cpp_source.html#l00616">chomp_optimizer.cpp:616</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompParameters_html_a76bb5c0214818b278cf5525b8e11f4b2"><div class="ttname"><a href="classchomp_1_1ChompParameters.html#a76bb5c0214818b278cf5525b8e11f4b2">chomp::ChompParameters::pseudo_inverse_ridge_factor_</a></div><div class="ttdeci">double pseudo_inverse_ridge_factor_</div><div class="ttdoc">enable pseudo inverse calculations or not.</div><div class="ttdef"><b>Definition:</b> <a href="chomp__parameters_8h_source.html#l00155">chomp_parameters.h:155</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_aacf642cdbcedc4e4ac82519aa09767ea"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#aacf642cdbcedc4e4ac82519aa09767ea">chomp::ChompOptimizer::jacobian_jacobian_tranpose_</a></div><div class="ttdeci">Eigen::MatrixXd jacobian_jacobian_tranpose_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00239">chomp_optimizer.h:239</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_ae25142ac19eff853f8e205c33c94d8f9"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#ae25142ac19eff853f8e205c33c94d8f9">chomp::ChompOptimizer::joint_parent_map_</a></div><div class="ttdeci">std::map&lt; std::string, std::map&lt; std::string, bool &gt; &gt; joint_parent_map_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00244">chomp_optimizer.h:244</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a18cc68cc4fd817ebf5f5e51297a8e7e8"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a18cc68cc4fd817ebf5f5e51297a8e7e8">chomp::ChompOptimizer::collision_point_vel_eigen_</a></div><div class="ttdeci">std::vector&lt; EigenSTL::vector_Vector3d &gt; collision_point_vel_eigen_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00205">chomp_optimizer.h:205</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_aee94008b982c7fd677c6c2191e5bfd75"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#aee94008b982c7fd677c6c2191e5bfd75">chomp::ChompOptimizer::iteration_</a></div><div class="ttdeci">int iteration_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00185">chomp_optimizer.h:185</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompCost_html"><div class="ttname"><a href="classchomp_1_1ChompCost.html">chomp::ChompCost</a></div><div class="ttdoc">Represents the smoothness cost for CHOMP, for a single joint.</div><div class="ttdef"><b>Definition:</b> <a href="chomp__cost_8h_source.html#l00080">chomp_cost.h:80</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_acf4ca8d231b15a584ae0ce98779850bd"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#acf4ca8d231b15a584ae0ce98779850bd">chomp::ChompOptimizer::joint_axes_</a></div><div class="ttdeci">std::vector&lt; EigenSTL::vector_Vector3d &gt; joint_axes_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00210">chomp_optimizer.h:210</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a45348d687e33567bade08b7c7d54f35a"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a45348d687e33567bade08b7c7d54f35a">chomp::ChompOptimizer::planning_scene_</a></div><div class="ttdeci">planning_scene::PlanningSceneConstPtr planning_scene_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00193">chomp_optimizer.h:193</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_ae5d0efa2d46c8d3ec261cab6a010ce8f"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#ae5d0efa2d46c8d3ec261cab6a010ce8f">chomp::ChompOptimizer::joint_names_</a></div><div class="ttdeci">std::vector&lt; std::string &gt; joint_names_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00243">chomp_optimizer.h:243</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_ac8a33d22edb4dac95d88480f0b114ba1"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#ac8a33d22edb4dac95d88480f0b114ba1">chomp::ChompOptimizer::group_trajectory_</a></div><div class="ttdeci">ChompTrajectory group_trajectory_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00192">chomp_optimizer.h:192</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a40a132a004cb8f02a496f552bdcefeb5"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a40a132a004cb8f02a496f552bdcefeb5">chomp::ChompOptimizer::hy_env_</a></div><div class="ttdeci">const collision_detection::CollisionEnvHybrid * hy_env_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00197">chomp_optimizer.h:197</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompTrajectory_html_a836c2da7e22cfee2acaf0b230feb6c1f"><div class="ttname"><a href="classchomp_1_1ChompTrajectory.html#a836c2da7e22cfee2acaf0b230feb6c1f">chomp::ChompTrajectory::getFreeJointTrajectoryBlock</a></div><div class="ttdeci">Eigen::Block&lt; Eigen::MatrixXd, Eigen::Dynamic, Eigen::Dynamic &gt; getFreeJointTrajectoryBlock(size_t joint)</div><div class="ttdoc">Gets the block of free (optimizable) trajectory for a single joint.</div><div class="ttdef"><b>Definition:</b> <a href="chomp__trajectory_8h_source.html#l00315">chomp_trajectory.h:315</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a290506c3d2fe5ea3f3b7ba24d5cf558a"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a290506c3d2fe5ea3f3b7ba24d5cf558a">chomp::ChompOptimizer::best_group_trajectory_cost_</a></div><div class="ttdeci">double best_group_trajectory_cost_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00214">chomp_optimizer.h:214</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a7eb2fa24e9cf2b0157b20d348a8cef86"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a7eb2fa24e9cf2b0157b20d348a8cef86">chomp::ChompOptimizer::state_is_in_collision_</a></div><div class="ttdeci">std::vector&lt; int &gt; state_is_in_collision_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00225">chomp_optimizer.h:225</a></div></div>
<div class="ttc" id="anamespacechomp_html"><div class="ttname"><a href="namespacechomp.html">chomp</a></div><div class="ttdef"><b>Definition:</b> <a href="chomp__cost_8h_source.html#l00043">chomp_cost.h:43</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_abc39cdc56e54ea91c6806d89021dccf9"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#abc39cdc56e54ea91c6806d89021dccf9">chomp::ChompOptimizer::last_improvement_iteration_</a></div><div class="ttdeci">int last_improvement_iteration_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00215">chomp_optimizer.h:215</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a58b03cf2a0276ed687f285dbfe3498e3"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a58b03cf2a0276ed687f285dbfe3498e3">chomp::ChompOptimizer::calculateCollisionIncrements</a></div><div class="ttdeci">void calculateCollisionIncrements()</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8cpp_source.html#l00625">chomp_optimizer.cpp:625</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a08e1bf73cd9db50dcfdfe627aba4282d"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a08e1bf73cd9db50dcfdfe627aba4282d">chomp::ChompOptimizer::ChompOptimizer</a></div><div class="ttdeci">ChompOptimizer(ChompTrajectory *trajectory, const planning_scene::PlanningSceneConstPtr &amp;planning_scene, const std::string &amp;planning_group, const ChompParameters *parameters, const moveit::core::RobotState &amp;start_state)</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8cpp_source.html#l00089">chomp_optimizer.cpp:89</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a45ee586e9c8e970059f81cc3b595d81f"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a45ee586e9c8e970059f81cc3b595d81f">chomp::ChompOptimizer::getCollisionCost</a></div><div class="ttdeci">double getCollisionCost()</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8cpp_source.html#l00768">chomp_optimizer.cpp:768</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a10178cbef38ab61ec8efe6ff1f537b37"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a10178cbef38ab61ec8efe6ff1f537b37">chomp::ChompOptimizer::num_vars_all_</a></div><div class="ttdeci">int num_vars_all_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00181">chomp_optimizer.h:181</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a9f4df819373a8fc4fc4c33bf3e61c3a2"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a9f4df819373a8fc4fc4c33bf3e61c3a2">chomp::ChompOptimizer::free_vars_end_</a></div><div class="ttdeci">int free_vars_end_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00184">chomp_optimizer.h:184</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a9d660cc8157a54e74a16608602ae2d4d"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a9d660cc8157a54e74a16608602ae2d4d">chomp::ChompOptimizer::perturbTrajectory</a></div><div class="ttdeci">void perturbTrajectory()</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8cpp_source.html#l01048">chomp_optimizer.cpp:1048</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompTrajectory_html_a848e22be4db55637dc2eb1141111c0c1"><div class="ttname"><a href="classchomp_1_1ChompTrajectory.html#a848e22be4db55637dc2eb1141111c0c1">chomp::ChompTrajectory::getJointVelocities</a></div><div class="ttdeci">void getJointVelocities(size_t traj_point, Eigen::MatrixBase&lt; Derived &gt; &amp;velocities)</div><div class="ttdoc">Gets the joint velocities at the given trajectory point.</div><div class="ttdef"><b>Definition:</b> <a href="chomp__trajectory_8h_source.html#l00326">chomp_trajectory.h:326</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_acfaa34daef6a1ac609561fefa6dba948"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#acfaa34daef6a1ac609561fefa6dba948">chomp::ChompOptimizer::isParent</a></div><div class="ttdeci">bool isParent(const std::string &amp;childLink, const std::string &amp;parentLink) const</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00246">chomp_optimizer.h:246</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_aa77c3cd6c65392e107c6aa732a0dd867"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#aa77c3cd6c65392e107c6aa732a0dd867">chomp::ChompOptimizer::robot_model_</a></div><div class="ttdeci">const moveit::core::RobotModelConstPtr &amp; robot_model_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00189">chomp_optimizer.h:189</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a3eeaf83e4d84b829c91d597d235e2805"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a3eeaf83e4d84b829c91d597d235e2805">chomp::ChompOptimizer::full_trajectory_</a></div><div class="ttdeci">ChompTrajectory * full_trajectory_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00188">chomp_optimizer.h:188</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_af2c89120550e89f097a5694b4484e610"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#af2c89120550e89f097a5694b4484e610">chomp::ChompOptimizer::initialized_</a></div><div class="ttdeci">bool initialized_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00201">chomp_optimizer.h:201</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a5b8fb75a78691f2ccfd19fbad87027d6"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a5b8fb75a78691f2ccfd19fbad87027d6">chomp::ChompOptimizer::getTrajectoryCost</a></div><div class="ttdeci">double getTrajectoryCost()</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8cpp_source.html#l00753">chomp_optimizer.cpp:753</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompParameters_html_aeec8f058d69671792f96c7fa0017e065"><div class="ttname"><a href="classchomp_1_1ChompParameters.html#aeec8f058d69671792f96c7fa0017e065">chomp::ChompParameters::obstacle_cost_weight_</a></div><div class="ttdeci">double obstacle_cost_weight_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__parameters_8h_source.html#l00137">chomp_parameters.h:137</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompParameters_html_a5fccd7eb47435c5a451c02a734a6859a"><div class="ttname"><a href="classchomp_1_1ChompParameters.html#a5fccd7eb47435c5a451c02a734a6859a">chomp::ChompParameters::smoothness_cost_jerk_</a></div><div class="ttdeci">double smoothness_cost_jerk_</div><div class="ttdoc">variables associated with the cost in acceleration</div><div class="ttdef"><b>Definition:</b> <a href="chomp__parameters_8h_source.html#l00144">chomp_parameters.h:144</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompParameters_html_ae03aabba1ced49e6f9dbbdd287adb02d"><div class="ttname"><a href="classchomp_1_1ChompParameters.html#ae03aabba1ced49e6f9dbbdd287adb02d">chomp::ChompParameters::joint_update_limit_</a></div><div class="ttdeci">double joint_update_limit_</div><div class="ttdoc">set the ridge factor if pseudo inverse is enabled</div><div class="ttdef"><b>Definition:</b> <a href="chomp__parameters_8h_source.html#l00157">chomp_parameters.h:157</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompTrajectory_html_a46b4d7d90712373552677264d74701be"><div class="ttname"><a href="classchomp_1_1ChompTrajectory.html#a46b4d7d90712373552677264d74701be">chomp::ChompTrajectory::getStartIndex</a></div><div class="ttdeci">size_t getStartIndex() const</div><div class="ttdoc">Gets the start index.</div><div class="ttdef"><b>Definition:</b> <a href="chomp__trajectory_8h_source.html#l00294">chomp_trajectory.h:294</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a636d147684c72ba10b6eac8624ceb20b"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a636d147684c72ba10b6eac8624ceb20b">chomp::ChompOptimizer::num_vars_free_</a></div><div class="ttdeci">int num_vars_free_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00180">chomp_optimizer.h:180</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a8de144c16b30bdb83c47c8b3ed84517f"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a8de144c16b30bdb83c47c8b3ed84517f">chomp::ChompOptimizer::collision_increments_</a></div><div class="ttdeci">Eigen::MatrixXd collision_increments_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00232">chomp_optimizer.h:232</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompTrajectory_html_ac4a59a86e9afc0616d9ee44a6440d348"><div class="ttname"><a href="classchomp_1_1ChompTrajectory.html#ac4a59a86e9afc0616d9ee44a6440d348">chomp::ChompTrajectory::getJointTrajectory</a></div><div class="ttdeci">Eigen::MatrixXd::ColXpr getJointTrajectory(int joint)</div><div class="ttdef"><b>Definition:</b> <a href="chomp__trajectory_8h_source.html#l00263">chomp_trajectory.h:263</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_abe45133eaaa4dfbc2224abaa25a5f7e1"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#abe45133eaaa4dfbc2224abaa25a5f7e1">chomp::ChompOptimizer::collision_point_pos_eigen_</a></div><div class="ttdeci">std::vector&lt; EigenSTL::vector_Vector3d &gt; collision_point_pos_eigen_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00204">chomp_optimizer.h:204</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a4068aed1b38efd2f54b85b62960a7662"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a4068aed1b38efd2f54b85b62960a7662">chomp::ChompOptimizer::collision_point_potential_</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; collision_point_potential_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00207">chomp_optimizer.h:207</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompTrajectory_html_a972938a9774b1e0654d56ed7dd7da0e9"><div class="ttname"><a href="classchomp_1_1ChompTrajectory.html#a972938a9774b1e0654d56ed7dd7da0e9">chomp::ChompTrajectory::getNumJoints</a></div><div class="ttdeci">size_t getNumJoints() const</div><div class="ttdoc">Gets the number of joints in each trajectory point.</div><div class="ttdef"><b>Definition:</b> <a href="chomp__trajectory_8h_source.html#l00278">chomp_trajectory.h:278</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a8bb956bcb8dbdc491c3339235cdec4a2"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a8bb956bcb8dbdc491c3339235cdec4a2">chomp::ChompOptimizer::optimize</a></div><div class="ttdeci">bool optimize()</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8cpp_source.html#l00336">chomp_optimizer.cpp:336</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_aa0a834c7c08af9c552178ae30ccc1673"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#aa0a834c7c08af9c552178ae30ccc1673">chomp::ChompOptimizer::calculateTotalIncrements</a></div><div class="ttdeci">void calculateTotalIncrements()</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8cpp_source.html#l00709">chomp_optimizer.cpp:709</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompParameters_html_a7687a2bc613fe773c56974072a7b257e"><div class="ttname"><a href="classchomp_1_1ChompParameters.html#a7687a2bc613fe773c56974072a7b257e">chomp::ChompParameters::filter_mode_</a></div><div class="ttdeci">bool filter_mode_</div><div class="ttdoc">the collision threshold cost that needs to be mainted to avoid collisions</div><div class="ttdef"><b>Definition:</b> <a href="chomp__parameters_8h_source.html#l00160">chomp_parameters.h:160</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_afc9b1c126a4051a508d59a021b0315c2"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#afc9b1c126a4051a508d59a021b0315c2">chomp::ChompOptimizer::point_is_in_collision_</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; int &gt; &gt; point_is_in_collision_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00227">chomp_optimizer.h:227</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a1e7ec0f06f19405956b5dab1e63f2c74"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a1e7ec0f06f19405956b5dab1e63f2c74">chomp::ChompOptimizer::performForwardKinematics</a></div><div class="ttdeci">void performForwardKinematics()</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8cpp_source.html#l00939">chomp_optimizer.cpp:939</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompParameters_html_a4b2be5cb20227e77576b5243f57d9522"><div class="ttname"><a href="classchomp_1_1ChompParameters.html#a4b2be5cb20227e77576b5243f57d9522">chomp::ChompParameters::use_pseudo_inverse_</a></div><div class="ttdeci">bool use_pseudo_inverse_</div><div class="ttdoc">the noise added to the diagnal of the total quadratic cost matrix in the objective function</div><div class="ttdef"><b>Definition:</b> <a href="chomp__parameters_8h_source.html#l00154">chomp_parameters.h:154</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompParameters_html_a193442a77a13bcd514d1df43d6594ab5"><div class="ttname"><a href="classchomp_1_1ChompParameters.html#a193442a77a13bcd514d1df43d6594ab5">chomp::ChompParameters::smoothness_cost_weight_</a></div><div class="ttdeci">double smoothness_cost_weight_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__parameters_8h_source.html#l00135">chomp_parameters.h:135</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompTrajectory_html_afb272cf4167ff09cf8a264e305e70b8f"><div class="ttname"><a href="classchomp_1_1ChompTrajectory.html#afb272cf4167ff09cf8a264e305e70b8f">chomp::ChompTrajectory::getNumFreePoints</a></div><div class="ttdeci">size_t getNumFreePoints() const</div><div class="ttdoc">Gets the number of points (that are free to be optimized) in the trajectory.</div><div class="ttdef"><b>Definition:</b> <a href="chomp__trajectory_8h_source.html#l00273">chomp_trajectory.h:273</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompParameters_html_a8a5689561abc217f035eb90623cfc2bc"><div class="ttname"><a href="classchomp_1_1ChompParameters.html#a8a5689561abc217f035eb90623cfc2bc">chomp::ChompParameters::ridge_factor_</a></div><div class="ttdeci">double ridge_factor_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__parameters_8h_source.html#l00153">chomp_parameters.h:153</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a41265fb8d09d499844098b979538d6df"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a41265fb8d09d499844098b979538d6df">chomp::ChompOptimizer::state_</a></div><div class="ttdeci">moveit::core::RobotState state_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00194">chomp_optimizer.h:194</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompTrajectory_html_a452a2c36a6935ca0e6c88c1830650954"><div class="ttname"><a href="classchomp_1_1ChompTrajectory.html#a452a2c36a6935ca0e6c88c1830650954">chomp::ChompTrajectory::getEndIndex</a></div><div class="ttdeci">size_t getEndIndex() const</div><div class="ttdoc">Gets the end index.</div><div class="ttdef"><b>Definition:</b> <a href="chomp__trajectory_8h_source.html#l00299">chomp_trajectory.h:299</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompParameters_html_aea2b23c848608c74ab3cfc768f103733"><div class="ttname"><a href="classchomp_1_1ChompParameters.html#aea2b23c848608c74ab3cfc768f103733">chomp::ChompParameters::max_iterations_</a></div><div class="ttdeci">int max_iterations_</div><div class="ttdoc">maximum time the optimizer can take to find a solution before terminating</div><div class="ttdef"><b>Definition:</b> <a href="chomp__parameters_8h_source.html#l00131">chomp_parameters.h:131</a></div></div>
<div class="ttc" id="anamespacechomp_html_a00ceb4fc5e1c66b78ed4f27ec5070890"><div class="ttname"><a href="namespacechomp.html#a00ceb4fc5e1c66b78ed4f27ec5070890">chomp::DIFF_RULE_LENGTH</a></div><div class="ttdeci">static const int DIFF_RULE_LENGTH</div><div class="ttdef"><b>Definition:</b> <a href="chomp__utils_8h_source.html#l00077">chomp_utils.h:77</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompParameters_html_a720d0351b9f2c20f27493c00a3a3173a"><div class="ttname"><a href="classchomp_1_1ChompParameters.html#a720d0351b9f2c20f27493c00a3a3173a">chomp::ChompParameters::use_stochastic_descent_</a></div><div class="ttdeci">bool use_stochastic_descent_</div><div class="ttdoc">variables associated with the cost in jerk</div><div class="ttdef"><b>Definition:</b> <a href="chomp__parameters_8h_source.html#l00147">chomp_parameters.h:147</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompTrajectory_html_a61bca7c981f6f94adaee9703828d34ff"><div class="ttname"><a href="classchomp_1_1ChompTrajectory.html#a61bca7c981f6f94adaee9703828d34ff">chomp::ChompTrajectory::getNumPoints</a></div><div class="ttdeci">size_t getNumPoints() const</div><div class="ttdoc">Gets the number of points in the trajectory.</div><div class="ttdef"><b>Definition:</b> <a href="chomp__trajectory_8h_source.html#l00268">chomp_trajectory.h:268</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a630a1c0d5720867f82d83e16b2d43778"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a630a1c0d5720867f82d83e16b2d43778">chomp::ChompOptimizer::jacobian_</a></div><div class="ttdeci">Eigen::MatrixXd jacobian_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00237">chomp_optimizer.h:237</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a54068cc585225da9b42b39f95a7a0354"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a54068cc585225da9b42b39f95a7a0354">chomp::ChompOptimizer::group_trajectory_backup_</a></div><div class="ttdeci">Eigen::MatrixXd group_trajectory_backup_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00212">chomp_optimizer.h:212</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a31c838ade46487693c228779d28c65a8"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a31c838ade46487693c228779d28c65a8">chomp::ChompOptimizer::worst_collision_cost_state_</a></div><div class="ttdeci">double worst_collision_cost_state_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00229">chomp_optimizer.h:229</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_ac115aaab6bcdf4ffc4bb3abbb7cc3320"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#ac115aaab6bcdf4ffc4bb3abbb7cc3320">chomp::ChompOptimizer::is_collision_free_</a></div><div class="ttdeci">bool is_collision_free_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00228">chomp_optimizer.h:228</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a16b9649944d27ac194464763f1c381a5"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a16b9649944d27ac194464763f1c381a5">chomp::ChompOptimizer::updateFullTrajectory</a></div><div class="ttdeci">void updateFullTrajectory()</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8cpp_source.html#l00740">chomp_optimizer.cpp:740</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_afee1f67cefc7f6e926bc13ae66389a48"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#afee1f67cefc7f6e926bc13ae66389a48">chomp::ChompOptimizer::registerParents</a></div><div class="ttdeci">void registerParents(const moveit::core::JointModel *model)</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8cpp_source.html#l00297">chomp_optimizer.cpp:297</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a9af8690faea1fe76e6c953d3ad554b56"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a9af8690faea1fe76e6c953d3ad554b56">chomp::ChompOptimizer::joint_positions_</a></div><div class="ttdeci">std::vector&lt; EigenSTL::vector_Vector3d &gt; joint_positions_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00211">chomp_optimizer.h:211</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_ada498aefc4c6e9c5a9ee6e7b0b71fefc"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#ada498aefc4c6e9c5a9ee6e7b0b71fefc">chomp::ChompOptimizer::num_joints_</a></div><div class="ttdeci">int num_joints_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00179">chomp_optimizer.h:179</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_ab1d91bec80485ee143fd1e8a37004100"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#ab1d91bec80485ee143fd1e8a37004100">chomp::ChompOptimizer::start_state_</a></div><div class="ttdeci">moveit::core::RobotState start_state_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00195">chomp_optimizer.h:195</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a694f826e2e33b3a12b4054951012a152"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a694f826e2e33b3a12b4054951012a152">chomp::ChompOptimizer::computeJointProperties</a></div><div class="ttdeci">void computeJointProperties(int trajectoryPoint)</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8cpp_source.html#l00794">chomp_optimizer.cpp:794</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompParameters_html_a7b0cd3dafbbde6d1d3afd1025a3a3e0d"><div class="ttname"><a href="classchomp_1_1ChompParameters.html#a7b0cd3dafbbde6d1d3afd1025a3a3e0d">chomp::ChompParameters::min_clearance_</a></div><div class="ttdeci">double min_clearance_</div><div class="ttdoc">set the update limit for the robot joints</div><div class="ttdef"><b>Definition:</b> <a href="chomp__parameters_8h_source.html#l00158">chomp_parameters.h:158</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompParameters_html_af603e620498d300bde1159e4edd3981c"><div class="ttname"><a href="classchomp_1_1ChompParameters.html#af603e620498d300bde1159e4edd3981c">chomp::ChompParameters::learning_rate_</a></div><div class="ttdeci">double learning_rate_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__parameters_8h_source.html#l00139">chomp_parameters.h:139</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a06fd3548c17ad7e728a7d1e6b9394bdd"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a06fd3548c17ad7e728a7d1e6b9394bdd">chomp::ChompOptimizer::smoothness_derivative_</a></div><div class="ttdeci">Eigen::VectorXd smoothness_derivative_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00236">chomp_optimizer.h:236</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a4fe49a4b1890b27815319f947cb30cf9"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a4fe49a4b1890b27815319f947cb30cf9">chomp::ChompOptimizer::final_increments_</a></div><div class="ttdeci">Eigen::MatrixXd final_increments_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00233">chomp_optimizer.h:233</a></div></div>
<div class="ttc" id="achomp__optimizer_8h_html"><div class="ttname"><a href="chomp__optimizer_8h.html">chomp_optimizer.h</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a5aacf2b5248010ed35f1d654a5739918"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a5aacf2b5248010ed35f1d654a5739918">chomp::ChompOptimizer::stochasticity_factor_</a></div><div class="ttdeci">double stochasticity_factor_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00223">chomp_optimizer.h:223</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_aa1ace51000e0432ef922b5ad7bd25bda"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#aa1ace51000e0432ef922b5ad7bd25bda">chomp::ChompOptimizer::calculatePseudoInverse</a></div><div class="ttdeci">void calculatePseudoInverse()</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8cpp_source.html#l00702">chomp_optimizer.cpp:702</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a88db4a4ea2dd1f55b819d21aab70785f"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a88db4a4ea2dd1f55b819d21aab70785f">chomp::ChompOptimizer::joint_state_velocities_</a></div><div class="ttdeci">Eigen::VectorXd joint_state_velocities_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00241">chomp_optimizer.h:241</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompTrajectory_html_a0e2396f83d3e6e93da03c01022f296c3"><div class="ttname"><a href="classchomp_1_1ChompTrajectory.html#a0e2396f83d3e6e93da03c01022f296c3">chomp::ChompTrajectory::getFreeTrajectoryBlock</a></div><div class="ttdeci">Eigen::Block&lt; Eigen::MatrixXd, Eigen::Dynamic, Eigen::Dynamic &gt; getFreeTrajectoryBlock()</div><div class="ttdoc">Gets the block of the trajectory which can be optimized.</div><div class="ttdef"><b>Definition:</b> <a href="chomp__trajectory_8h_source.html#l00309">chomp_trajectory.h:309</a></div></div>
<div class="ttc" id="anamespacechomp_html_a3cb4d6d2179e5505bce99ccf70e4b61e"><div class="ttname"><a href="namespacechomp.html#a3cb4d6d2179e5505bce99ccf70e4b61e">chomp::getRandomDouble</a></div><div class="ttdeci">double getRandomDouble()</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8cpp_source.html#l00082">chomp_optimizer.cpp:82</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompParameters_html_a6d1eeb3dec5f60058775b67bc748977b"><div class="ttname"><a href="classchomp_1_1ChompParameters.html#a6d1eeb3dec5f60058775b67bc748977b">chomp::ChompParameters::smoothness_cost_acceleration_</a></div><div class="ttdeci">double smoothness_cost_acceleration_</div><div class="ttdoc">variables associated with the cost in velocity</div><div class="ttdef"><b>Definition:</b> <a href="chomp__parameters_8h_source.html#l00143">chomp_parameters.h:143</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a34399fd4b1c32f1a43cac03ec531f455"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a34399fd4b1c32f1a43cac03ec531f455">chomp::ChompOptimizer::getSmoothnessCost</a></div><div class="ttdeci">double getSmoothnessCost()</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8cpp_source.html#l00758">chomp_optimizer.cpp:758</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a836de9ad21ca36219b237be668376969"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a836de9ad21ca36219b237be668376969">chomp::ChompOptimizer::handleJointLimits</a></div><div class="ttdeci">void handleJointLimits()</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8cpp_source.html#l00858">chomp_optimizer.cpp:858</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a2d645e404e612383fc506ac65935a88d"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a2d645e404e612383fc506ac65935a88d">chomp::ChompOptimizer::~ChompOptimizer</a></div><div class="ttdeci">virtual ~ChompOptimizer()</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8cpp_source.html#l00292">chomp_optimizer.cpp:292</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_a15f03bdad314356db449de130f9be5e8"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#a15f03bdad314356db449de130f9be5e8">chomp::ChompOptimizer::debugCost</a></div><div class="ttdeci">void debugCost()</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8cpp_source.html#l00745">chomp_optimizer.cpp:745</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_ad522962453ef1b68c88b0d177e49add6"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#ad522962453ef1b68c88b0d177e49add6">chomp::ChompOptimizer::joint_costs_</a></div><div class="ttdeci">std::vector&lt; ChompCost &gt; joint_costs_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00199">chomp_optimizer.h:199</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_ab2028b705c347074aef529a0c4a93534"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#ab2028b705c347074aef529a0c4a93534">chomp::ChompOptimizer::free_vars_start_</a></div><div class="ttdeci">int free_vars_start_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00183">chomp_optimizer.h:183</a></div></div>
<div class="ttc" id="aclasschomp_1_1ChompOptimizer_html_ac6696b62d069c117952aeca2b23de40a"><div class="ttname"><a href="classchomp_1_1ChompOptimizer.html#ac6696b62d069c117952aeca2b23de40a">chomp::ChompOptimizer::collision_point_vel_mag_</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; double &gt; &gt; collision_point_vel_mag_</div><div class="ttdef"><b>Definition:</b> <a href="chomp__optimizer_8h_source.html#l00208">chomp_optimizer.h:208</a></div></div>

<br clear="all" />
<hr size="1"><div style="align: right;">
<a href="http://wiki.ros.org/chomp_motion_planner">chomp_motion_planner</a><br />
Author(s): Gil Jones <gjones@willowgarage.com>, Mrinal Kalakrishnan <mail@mrinal.net></br />
<small>autogenerated on Tue Oct 19 2021 13:04:24</small>
</div>
</body>
</html>
